Updating build index: /Users/runner/conda/conda-bld

TEST START: /var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T/tmptl6pt1xp/noarch/microhapulator-0.4.1-py_0.tar.bz2
Adding in variants from internal_defaults
Adding in variants from /var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T/tmpb9y9z0h2/info/recipe/conda_build_config.yaml
Reloading output folder: /Users/runner/conda/conda-bld
  Package                    Version  Build               Channel                                                                   Size
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  Install:
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────

  + attrs                     21.2.0  pyhd8ed1ab_0        conda-forge/noarch                                                      Cached
  + biopython                   1.78  py39h89e85a6_2      conda-forge/osx-64                                                        3 MB
  + brotlipy                   0.7.0  py39h89e85a6_1001   conda-forge/osx-64                                                      Cached
  + bzip2                      1.0.8  h0d85af4_4          conda-forge/osx-64                                                      Cached
  + c-ares                    1.17.2  h0d85af4_0          conda-forge/osx-64                                                      Cached
  + ca-certificates        2021.10.8  h033912b_0          conda-forge/osx-64                                                      Cached
  + certifi                2021.10.8  py39h6e9494a_0      conda-forge/osx-64                                                      Cached
  + cffi                      1.14.6  py39he338e87_1      conda-forge/osx-64                                                      Cached
  + chardet                    4.0.0  py39h6e9494a_1      conda-forge/osx-64                                                      Cached
  + charset-normalizer         2.0.0  pyhd8ed1ab_0        conda-forge/noarch                                                      Cached
  + coverage                   6.0.2  py39h89e85a6_0      conda-forge/osx-64                                                      281 KB
  + cryptography              35.0.0  py39heaea23e_0      conda-forge/osx-64                                                      Cached
  + future                    0.18.2  py39h6e9494a_3      conda-forge/osx-64                                                      Cached
  + happer                     0.1.1  py_0                bioconda/noarch                                                          15 KB
  + idna                         3.1  pyhd3deb0d_0        conda-forge/noarch                                                      Cached
  + importlib-metadata         4.8.1  py39h6e9494a_0      conda-forge/osx-64                                                      Cached
  + iniconfig                  1.1.1  pyh9f0ad1d_0        conda-forge/noarch                                                        8 KB
  + insilicoseq                1.5.4  pyh5e36f6f_0        bioconda/noarch                                                           1 MB
  + joblib                     1.1.0  pyhd8ed1ab_0        conda-forge/noarch                                                      Cached
  + jsonschema                 4.1.2  pyhd8ed1ab_0        conda-forge/noarch                                                      Cached
  + krb5                      1.19.2  hcfbf3a7_2          conda-forge/osx-64                                                      Cached
  + libblas                    3.9.0  12_osx64_openblas   conda-forge/osx-64                                                      Cached
  + libcblas                   3.9.0  12_osx64_openblas   conda-forge/osx-64                                                      Cached
  + libcurl                   7.79.1  hf45b732_1          conda-forge/osx-64                                                      Cached
  + libcxx                    12.0.1  habf9029_0          conda-forge/osx-64                                                      Cached
  + libdeflate                   1.7  h35c211d_5          conda-forge/osx-64                                                       67 KB
  + libedit             3.1.20191231  h0678c8f_2          conda-forge/osx-64                                                      Cached
  + libev                       4.33  haf1e3a3_1          conda-forge/osx-64                                                      Cached
  + libffi                     3.4.2  he49afe7_4          conda-forge/osx-64                                                      Cached
  + libgfortran                5.0.0  9_3_0_h6c81a4c_23   conda-forge/osx-64                                                      Cached
  + libgfortran5               9.3.0  h6c81a4c_23         conda-forge/osx-64                                                      Cached
  + liblapack                  3.9.0  12_osx64_openblas   conda-forge/osx-64                                                      Cached
  + libnghttp2                1.43.0  h6f36284_1          conda-forge/osx-64                                                      Cached
  + libopenblas               0.3.18  openmp_h3351f45_0   conda-forge/osx-64                                                      Cached
  + libssh2                   1.10.0  h52ee1ee_2          conda-forge/osx-64                                                      Cached
  + libzlib                   1.2.11  h9173be1_1013       conda-forge/osx-64                                                      Cached
  + llvm-openmp               12.0.1  hda6cdc1_1          conda-forge/osx-64                                                      Cached
  + microhapdb                   0.6  py_0                bioconda/noarch                                                         678 KB
  + microhapulator             0.4.1  py_0                /var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T/tmptl6pt1xp/noarch       3 MB
  + more-itertools            8.10.0  pyhd8ed1ab_0        conda-forge/noarch                                                       44 KB
  + ncurses                      6.2  h2e338ed_4          conda-forge/osx-64                                                      Cached
  + numpy                     1.21.3  py39h7eed0ac_0      conda-forge/osx-64                                                        6 MB
  + openssl                   1.1.1l  h0d85af4_0          conda-forge/osx-64                                                      Cached
  + packaging                   21.0  pyhd8ed1ab_0        conda-forge/noarch                                                       35 KB
  + pandas                     1.3.4  py39h4d6be9b_0      conda-forge/osx-64                                                       12 MB
  + pip                         21.3  pyhd8ed1ab_0        conda-forge/noarch                                                      Cached
  + pluggy                     1.0.0  py39h6e9494a_1      conda-forge/osx-64                                                       25 KB
  + py                        1.10.0  pyhd3deb0d_0        conda-forge/noarch                                                       73 KB
  + pycparser                   2.20  pyh9f0ad1d_2        conda-forge/noarch                                                      Cached
  + pyopenssl                 21.0.0  pyhd8ed1ab_0        conda-forge/noarch                                                      Cached
  + pyparsing                  2.4.7  pyh9f0ad1d_0        conda-forge/noarch                                                       60 KB
  + pyrsistent                0.17.3  py39h89e85a6_2      conda-forge/osx-64                                                      Cached
  + pysam                     0.17.0  py39h56703ae_0      bioconda/osx-64                                                           2 MB
  + pysocks                    1.7.1  py39h6e9494a_3      conda-forge/osx-64                                                      Cached
  + pytest                     6.2.5  py39h6e9494a_0      conda-forge/osx-64                                                      432 KB
  + pytest-cov                 3.0.0  pyhd8ed1ab_0        conda-forge/noarch                                                       21 KB
  + python                     3.9.7  h1248fe1_3_cpython  conda-forge/osx-64                                                      Cached
  + python-dateutil            2.8.2  pyhd8ed1ab_0        conda-forge/noarch                                                      240 KB
  + python_abi                   3.9  2_cp39              conda-forge/osx-64                                                      Cached
  + pytz                      2021.3  pyhd8ed1ab_0        conda-forge/noarch                                                      Cached
  + readline                     8.1  h05e3726_0          conda-forge/osx-64                                                      Cached
  + requests                  2.26.0  pyhd8ed1ab_0        conda-forge/noarch                                                      Cached
  + scipy                      1.7.1  py39h056f1c0_0      conda-forge/osx-64                                                       20 MB
  + setuptools                58.2.0  py39h6e9494a_0      conda-forge/osx-64                                                      Cached
  + six                       1.16.0  pyh6c4a22f_0        conda-forge/noarch                                                      Cached
  + sqlite                    3.36.0  h23a322b_2          conda-forge/osx-64                                                      Cached
  + tk                        8.6.11  h5dbffcc_1          conda-forge/osx-64                                                      Cached
  + toml                      0.10.2  pyhd8ed1ab_0        conda-forge/noarch                                                       18 KB
  + tomli                      1.2.1  pyhd8ed1ab_0        conda-forge/noarch                                                       15 KB
  + tzdata                     2021d  he74cb21_0          conda-forge/noarch                                                      Cached
  + urllib3                   1.26.7  pyhd8ed1ab_0        conda-forge/noarch                                                      Cached
  + wheel                     0.37.0  pyhd8ed1ab_1        conda-forge/noarch                                                      Cached
  + xz                         5.2.5  haf1e3a3_1          conda-forge/osx-64                                                      Cached
  + zipp                       3.6.0  pyhd8ed1ab_0        conda-forge/noarch                                                      Cached
  + zlib                      1.2.11  h9173be1_1013       conda-forge/osx-64                                                      Cached

  Summary:

  Install: 75 packages

  Total download: 48 MB

──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


## Package Plan ##

  environment location: /Users/runner/conda/conda-bld/microhapulator_1634874689814/_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_plac


The following NEW packages will be INSTALLED:

    attrs:              21.2.0-pyhd8ed1ab_0      conda-forge                                                        
    biopython:          1.78-py39h89e85a6_2      conda-forge                                                        
    brotlipy:           0.7.0-py39h89e85a6_1001  conda-forge                                                        
    bzip2:              1.0.8-h0d85af4_4         conda-forge                                                        
    c-ares:             1.17.2-h0d85af4_0        conda-forge                                                        
    ca-certificates:    2021.10.8-h033912b_0     conda-forge                                                        
    certifi:            2021.10.8-py39h6e9494a_0 conda-forge                                                        
    cffi:               1.14.6-py39he338e87_1    conda-forge                                                        
    chardet:            4.0.0-py39h6e9494a_1     conda-forge                                                        
    charset-normalizer: 2.0.0-pyhd8ed1ab_0       conda-forge                                                        
    coverage:           6.0.2-py39h89e85a6_0     conda-forge                                                        
    cryptography:       35.0.0-py39heaea23e_0    conda-forge                                                        
    future:             0.18.2-py39h6e9494a_3    conda-forge                                                        
    happer:             0.1.1-py_0               bioconda                                                           
    idna:               3.1-pyhd3deb0d_0         conda-forge                                                        
    importlib-metadata: 4.8.1-py39h6e9494a_0     conda-forge                                                        
    iniconfig:          1.1.1-pyh9f0ad1d_0       conda-forge                                                        
    insilicoseq:        1.5.4-pyh5e36f6f_0       bioconda                                                           
    joblib:             1.1.0-pyhd8ed1ab_0       conda-forge                                                        
    jsonschema:         4.1.2-pyhd8ed1ab_0       conda-forge                                                        
    krb5:               1.19.2-hcfbf3a7_2        conda-forge                                                        
    libblas:            3.9.0-12_osx64_openblas  conda-forge                                                        
    libcblas:           3.9.0-12_osx64_openblas  conda-forge                                                        
    libcurl:            7.79.1-hf45b732_1        conda-forge                                                        
    libcxx:             12.0.1-habf9029_0        conda-forge                                                        
    libdeflate:         1.7-h35c211d_5           conda-forge                                                        
    libedit:            3.1.20191231-h0678c8f_2  conda-forge                                                        
    libev:              4.33-haf1e3a3_1          conda-forge                                                        
    libffi:             3.4.2-he49afe7_4         conda-forge                                                        
    libgfortran:        5.0.0-9_3_0_h6c81a4c_23  conda-forge                                                        
    libgfortran5:       9.3.0-h6c81a4c_23        conda-forge                                                        
    liblapack:          3.9.0-12_osx64_openblas  conda-forge                                                        
    libnghttp2:         1.43.0-h6f36284_1        conda-forge                                                        
    libopenblas:        0.3.18-openmp_h3351f45_0 conda-forge                                                        
    libssh2:            1.10.0-h52ee1ee_2        conda-forge                                                        
    libzlib:            1.2.11-h9173be1_1013     conda-forge                                                        
    llvm-openmp:        12.0.1-hda6cdc1_1        conda-forge                                                        
    microhapdb:         0.6-py_0                 bioconda                                                           
    microhapulator:     0.4.1-py_0               file:///var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T/tmptl6pt1xp
    more-itertools:     8.10.0-pyhd8ed1ab_0      conda-forge                                                        
    ncurses:            6.2-h2e338ed_4           conda-forge                                                        
    numpy:              1.21.3-py39h7eed0ac_0    conda-forge                                                        
    openssl:            1.1.1l-h0d85af4_0        conda-forge                                                        
    packaging:          21.0-pyhd8ed1ab_0        conda-forge                                                        
    pandas:             1.3.4-py39h4d6be9b_0     conda-forge                                                        
    pip:                21.3-pyhd8ed1ab_0        conda-forge                                                        
    pluggy:             1.0.0-py39h6e9494a_1     conda-forge                                                        
    py:                 1.10.0-pyhd3deb0d_0      conda-forge                                                        
    pycparser:          2.20-pyh9f0ad1d_2        conda-forge                                                        
    pyopenssl:          21.0.0-pyhd8ed1ab_0      conda-forge                                                        
    pyparsing:          2.4.7-pyh9f0ad1d_0       conda-forge                                                        
    pyrsistent:         0.17.3-py39h89e85a6_2    conda-forge                                                        
    pysam:              0.17.0-py39h56703ae_0    bioconda                                                           
    pysocks:            1.7.1-py39h6e9494a_3     conda-forge                                                        
    pytest:             6.2.5-py39h6e9494a_0     conda-forge                                                        
    pytest-cov:         3.0.0-pyhd8ed1ab_0       conda-forge                                                        
    python:             3.9.7-h1248fe1_3_cpython conda-forge                                                        
    python-dateutil:    2.8.2-pyhd8ed1ab_0       conda-forge                                                        
    python_abi:         3.9-2_cp39               conda-forge                                                        
    pytz:               2021.3-pyhd8ed1ab_0      conda-forge                                                        
    readline:           8.1-h05e3726_0           conda-forge                                                        
    requests:           2.26.0-pyhd8ed1ab_0      conda-forge                                                        
    scipy:              1.7.1-py39h056f1c0_0     conda-forge                                                        
    setuptools:         58.2.0-py39h6e9494a_0    conda-forge                                                        
    six:                1.16.0-pyh6c4a22f_0      conda-forge                                                        
    sqlite:             3.36.0-h23a322b_2        conda-forge                                                        
    tk:                 8.6.11-h5dbffcc_1        conda-forge                                                        
    toml:               0.10.2-pyhd8ed1ab_0      conda-forge                                                        
    tomli:              1.2.1-pyhd8ed1ab_0       conda-forge                                                        
    tzdata:             2021d-he74cb21_0         conda-forge                                                        
    urllib3:            1.26.7-pyhd8ed1ab_0      conda-forge                                                        
    wheel:              0.37.0-pyhd8ed1ab_1      conda-forge                                                        
    xz:                 5.2.5-haf1e3a3_1         conda-forge                                                        
    zipp:               3.6.0-pyhd8ed1ab_0       conda-forge                                                        
    zlib:               1.2.11-h9173be1_1013     conda-forge                                                        

Preparing transaction: ...working... done
Verifying transaction: ...working... done
Executing transaction: ...working... done
export PREFIX=/Users/runner/conda/conda-bld/microhapulator_1634874689814/_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_plac
export SRC_DIR=/Users/runner/conda/conda-bld/microhapulator_1634874689814/test_tmp
import: 'microhapulator'
import: 'microhapulator'
============================= test session starts ==============================
platform darwin -- Python 3.9.7, pytest-6.2.5, py-1.10.0, pluggy-1.0.0
rootdir: $SRC_DIR
plugins: cov-3.0.0
collected 80 items

tests/test_cli.py .                                                      [  1%]
tests/test_contain.py ....                                               [  6%]
tests/test_contrib.py .........                                          [ 17%]
tests/test_diff.py ....                                                  [ 22%]
tests/test_dist.py .............                                         [ 38%]
tests/test_mix.py .                                                      [ 40%]
tests/test_prob.py ..........                                            [ 52%]
tests/test_profile.py .......                                            [ 61%]
tests/test_seq.py ..........F..                                          [ 77%]
tests/test_sim.py F.FFF...                                               [ 87%]
tests/test_type.py .....                                                 [ 93%]
tests/test_unite.py .....                                                [100%]

=================================== FAILURES ===================================
_ test_main_relaxed[True-red-relaxed-profile.json-kSW9IlM-red-reads-relaxed.fastq] _

relaxmode = True, gtfile = 'red-relaxed-profile.json', signature = 'kSW9IlM'
testfile = 'red-reads-relaxed.fastq'

    @pytest.mark.parametrize('relaxmode,gtfile,signature,testfile', [
        (False, 'red-strict-profile.json', 'ihkSW9I', 'red-reads-strict.fastq'),
        (True, 'red-relaxed-profile.json', 'kSW9IlM', 'red-reads-relaxed.fastq'),
    ])
    def test_main_relaxed(relaxmode, gtfile, signature, testfile):
        with NamedTemporaryFile(suffix='.fastq') as outfile:
            arglist = [
                'seq', '--out', outfile.name, '--seeds', '24680', '--num-reads', '100',
                '--signature', signature, data_file(gtfile)
            ]
            args = microhapulator.cli.get_parser().parse_args(arglist)
            args.relaxed = relaxmode
            microhapulator.seq.main(args)
>           assert filecmp.cmp(outfile.name, data_file(testfile))
E           AssertionError: assert False
E            +  where False = <function cmp at 0x13917c4c0>('/var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T/tmpgd2n835p.fastq', '/Users/runner/conda/conda-bld/microhapulator_1634874689814/_test_env_placehold_placehold_placehold_placehold_placehol...ehold_placehold_placehold_placehold_plac/lib/python3.9/site-packages/microhapulator/tests/data/red-reads-relaxed.fastq')
E            +    where <function cmp at 0x13917c4c0> = filecmp.cmp
E            +    and   '/var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T/tmpgd2n835p.fastq' = <tempfile._TemporaryFileWrapper object at 0x1391f61c0>.name
E            +    and   '/Users/runner/conda/conda-bld/microhapulator_1634874689814/_test_env_placehold_placehold_placehold_placehold_placehol...ehold_placehold_placehold_placehold_plac/lib/python3.9/site-packages/microhapulator/tests/data/red-reads-relaxed.fastq' = data_file('red-reads-relaxed.fastq')

../_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_plac/lib/python3.9/site-packages/microhapulator/tests/test_seq.py:122: AssertionError
----------------------------- Captured stderr call -----------------------------
[MicroHapulator::seq] Individual seed=24680 numreads=100
_____________________________ test_meaning_of_life _____________________________

    def test_meaning_of_life():
>       profile = microhapulator.sim.sim(['SA004250L', 'SA004250L'], ['beta'], seed=42)

../_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_plac/lib/python3.9/site-packages/microhapulator/tests/test_sim.py:20: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_plac/lib/python3.9/site-packages/microhapulator/sim.py:42: in sim
    markers = panel_markers(panel)
../_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_plac/lib/python3.9/site-packages/microhapulator/panel.py:21: in panel_markers
    markers = panel_beta()
../_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_plac/lib/python3.9/site-packages/microhapulator/panel.py:69: in panel_beta
    & (markers.AvgAe > 2.0)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self =             Name          PermID Reference  ...      Start        End  Length
0     mh01KK-172  MHDBM-d5a744a2    GRCh...38369297      31
416  mh0XUSC-XqH  MHDBM-cba70b3c    GRCh38  ...  146934523  146934545      22

[417 rows x 12 columns]
name = 'AvgAe'

    def __getattr__(self, name: str):
        """
        After regular attribute access, try looking up the name
        This allows simpler access to columns for interactive use.
        """
        # Note: obj.x will always call obj.__getattribute__('x') prior to
        # calling obj.__getattr__('x').
        if (
            name not in self._internal_names_set
            and name not in self._metadata
            and name not in self._accessors
            and self._info_axis._can_hold_identifiers_and_holds_name(name)
        ):
            return self[name]
>       return object.__getattribute__(self, name)
E       AttributeError: 'DataFrame' object has no attribute 'AvgAe'

../_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_plac/lib/python3.9/site-packages/pandas/core/generic.py:5487: AttributeError
_______________ test_sim_relaxed[True-red-relaxed-profile.json] ________________

relaxmode = True, testfile = 'red-relaxed-profile.json'

    @pytest.mark.parametrize('relaxmode,testfile', [
        (False, 'red-strict-profile.json'),
        (True, 'red-relaxed-profile.json'),
    ])
    def test_sim_relaxed(relaxmode, testfile):
        profile = microhapulator.sim.sim(
            ['SA000101C'], ['mh01KK-117', 'mh09KK-157', 'mh07CP-004'],
            seed=54321, relaxed=relaxmode
        )
        testprofile = SimulatedProfile(fromfile=data_file(testfile))
>       assert profile == testprofile
E       assert <microhapulator.profile.SimulatedProfile object at 0x1393486d0> == <microhapulator.profile.SimulatedProfile object at 0x139348490>

../_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_plac/lib/python3.9/site-packages/microhapulator/tests/test_sim.py:35: AssertionError
----------------------------- Captured stderr call -----------------------------
[MicroHapulator::panel] WARNING: no allele frequencies available for population "SA000101C" at marker "mh07CP-004"; in "relaxed" mode, drawing an allele uniformly
[MicroHapulator::panel] WARNING: no allele frequencies available for population "SA000101C" at marker "mh07CP-004"; in "relaxed" mode, drawing an allele uniformly
[MicroHapulator::sim] simulated microhaplotype variation at 3 markers
__________________________________ test_main ___________________________________

    def test_main():
        with tempfile.NamedTemporaryFile(suffix='-profile.json') as outfile:
            arglist = [
                'sim', '--out', outfile.name, '--seed', '1985', 'SA004250L', 'SA004250L',
                'usa'
            ]
            args = microhapulator.cli.get_parser().parse_args(arglist)
>           microhapulator.sim.main(args)

../_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_plac/lib/python3.9/site-packages/microhapulator/tests/test_sim.py:45: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_plac/lib/python3.9/site-packages/microhapulator/sim.py:65: in main
    profile = sim(args.popid, panel, seed=args.seed, relaxed=args.relaxed)
../_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_plac/lib/python3.9/site-packages/microhapulator/sim.py:42: in sim
    markers = panel_markers(panel)
../_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_plac/lib/python3.9/site-packages/microhapulator/panel.py:23: in panel_markers
    markers = panel_usa()
../_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_plac/lib/python3.9/site-packages/microhapulator/panel.py:116: in panel_usa
    panel = markers[
../_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_plac/lib/python3.9/site-packages/pandas/util/_decorators.py:311: in wrapper
    return func(*args, **kwargs)
../_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_plac/lib/python3.9/site-packages/pandas/core/frame.py:6259: in sort_values
    k = self._get_label_or_level_values(by, axis=axis)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = Empty DataFrame
Columns: [Name, PermID, Reference, Chrom, Offsets, Ae, In, Fst, Source, NumVariants]
Index: []
key = 'AvgAe', axis = 0

    @final
    def _get_label_or_level_values(self, key: str, axis: int = 0) -> np.ndarray:
        """
        Return a 1-D array of values associated with `key`, a label or level
        from the given `axis`.
    
        Retrieval logic:
          - (axis=0): Return column values if `key` matches a column label.
            Otherwise return index level values if `key` matches an index
            level.
          - (axis=1): Return row values if `key` matches an index label.
            Otherwise return column level values if 'key' matches a column
            level
    
        Parameters
        ----------
        key : str
            Label or level name.
        axis : int, default 0
            Axis that levels are associated with (0 for index, 1 for columns)
    
        Returns
        -------
        values : np.ndarray
    
        Raises
        ------
        KeyError
            if `key` matches neither a label nor a level
        ValueError
            if `key` matches multiple labels
        FutureWarning
            if `key` is ambiguous. This will become an ambiguity error in a
            future version
        """
        axis = self._get_axis_number(axis)
        other_axes = [ax for ax in range(self._AXIS_LEN) if ax != axis]
    
        if self._is_label_reference(key, axis=axis):
            self._check_label_or_level_ambiguity(key, axis=axis)
            values = self.xs(key, axis=other_axes[0])._values
        elif self._is_level_reference(key, axis=axis):
            values = self.axes[axis].get_level_values(key)._values
        else:
>           raise KeyError(key)
E           KeyError: 'AvgAe'

../_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_plac/lib/python3.9/site-packages/pandas/core/generic.py:1779: KeyError
_____________________________ test_main_haplo_seq ______________________________

    def test_main_haplo_seq():
        tempdir = tempfile.mkdtemp()
        try:
            arglist = [
                'sim', '--seed', '293847', '--out', tempdir + '/profile.json',
                '--haplo-seq', tempdir + '/haplo.fasta', 'SA004047P', 'SA004047P',
                'mh07CP-004', 'mh14CP-003'
            ]
            args = microhapulator.cli.get_parser().parse_args(arglist)
            microhapulator.sim.main(args)
            p = SimulatedProfile(fromfile=tempdir + '/profile.json')
            testp = SimulatedProfile(fromfile=data_file('orange-sim-profile.json'))
>           assert p == testp
E           assert <microhapulator.profile.SimulatedProfile object at 0x139362df0> == <microhapulator.profile.SimulatedProfile object at 0x139362ca0>

../_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_plac/lib/python3.9/site-packages/microhapulator/tests/test_sim.py:63: AssertionError
----------------------------- Captured stderr call -----------------------------
[MicroHapulator::sim] simulated microhaplotype variation at 2 markers
[MicroHapulator::sim] profile JSON written to /var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T/tmpnuo23vfq/profile.json
[MicroHapulator::sim] haplotype sequences written to /var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T/tmpnuo23vfq/haplo.fasta

---------- coverage: platform darwin, python 3.9.7-final-0 -----------
Name                                                                                                                                                                                                                                                                                                                             Stmts   Miss  Cover
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
$PREFIX/lib/python3.9/site-packages/microhapulator/__init__.py                46      1    98%
$PREFIX/lib/python3.9/site-packages/microhapulator/__main__.py                 1      0   100%
$PREFIX/lib/python3.9/site-packages/microhapulator/_version.py                 4      0   100%
$PREFIX/lib/python3.9/site-packages/microhapulator/cli/__init__.py            28      0   100%
$PREFIX/lib/python3.9/site-packages/microhapulator/cli/contain.py              5      0   100%
$PREFIX/lib/python3.9/site-packages/microhapulator/cli/contrib.py              6      0   100%
$PREFIX/lib/python3.9/site-packages/microhapulator/cli/diff.py                 5      0   100%
$PREFIX/lib/python3.9/site-packages/microhapulator/cli/dist.py                 5      0   100%
$PREFIX/lib/python3.9/site-packages/microhapulator/cli/mix.py                  4      0   100%
$PREFIX/lib/python3.9/site-packages/microhapulator/cli/prob.py                 8      0   100%
$PREFIX/lib/python3.9/site-packages/microhapulator/cli/seq.py                 12      0   100%
$PREFIX/lib/python3.9/site-packages/microhapulator/cli/sim.py                  9      0   100%
$PREFIX/lib/python3.9/site-packages/microhapulator/cli/type.py                 7      0   100%
$PREFIX/lib/python3.9/site-packages/microhapulator/cli/unite.py                6      0   100%
$PREFIX/lib/python3.9/site-packages/microhapulator/contain.py                 17      0   100%
$PREFIX/lib/python3.9/site-packages/microhapulator/contrib.py                 26      0   100%
$PREFIX/lib/python3.9/site-packages/microhapulator/diff.py                    21      0   100%
$PREFIX/lib/python3.9/site-packages/microhapulator/dist.py                    16      0   100%
$PREFIX/lib/python3.9/site-packages/microhapulator/mix.py                      7      0   100%
$PREFIX/lib/python3.9/site-packages/microhapulator/panel.py                  118     28    76%
$PREFIX/lib/python3.9/site-packages/microhapulator/prob.py                    21      0   100%
$PREFIX/lib/python3.9/site-packages/microhapulator/profile.py                234      1    99%
$PREFIX/lib/python3.9/site-packages/microhapulator/seq.py                     81      6    93%
$PREFIX/lib/python3.9/site-packages/microhapulator/sim.py                     46      0   100%
$PREFIX/lib/python3.9/site-packages/microhapulator/tests/__init__.py           6      0   100%
$PREFIX/lib/python3.9/site-packages/microhapulator/tests/test_cli.py          12      0   100%
$PREFIX/lib/python3.9/site-packages/microhapulator/tests/test_contain.py      18      0   100%
$PREFIX/lib/python3.9/site-packages/microhapulator/tests/test_contrib.py      29      0   100%
$PREFIX/lib/python3.9/site-packages/microhapulator/tests/test_diff.py         38      0   100%
$PREFIX/lib/python3.9/site-packages/microhapulator/tests/test_dist.py         41      0   100%
$PREFIX/lib/python3.9/site-packages/microhapulator/tests/test_mix.py          13      0   100%
$PREFIX/lib/python3.9/site-packages/microhapulator/tests/test_prob.py         47      0   100%
$PREFIX/lib/python3.9/site-packages/microhapulator/tests/test_profile.py      87      0   100%
$PREFIX/lib/python3.9/site-packages/microhapulator/tests/test_seq.py          96      0   100%
$PREFIX/lib/python3.9/site-packages/microhapulator/tests/test_sim.py          46      5    89%
$PREFIX/lib/python3.9/site-packages/microhapulator/tests/test_type.py         42      0   100%
$PREFIX/lib/python3.9/site-packages/microhapulator/tests/test_unite.py        34      0   100%
$PREFIX/lib/python3.9/site-packages/microhapulator/type.py                    72      1    99%
$PREFIX/lib/python3.9/site-packages/microhapulator/unite.py                   10      0   100%
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
TOTAL                                                                                                                                                                                                                                                                                                                             1324     42    97%

=========================== short test summary info ============================
FAILED tests/test_seq.py::test_main_relaxed[True-red-relaxed-profile.json-kSW9IlM-red-reads-relaxed.fastq]
FAILED tests/test_sim.py::test_meaning_of_life - AttributeError: 'DataFrame' ...
FAILED tests/test_sim.py::test_sim_relaxed[True-red-relaxed-profile.json] - a...
FAILED tests/test_sim.py::test_main - KeyError: 'AvgAe'
FAILED tests/test_sim.py::test_main_haplo_seq - assert <microhapulator.profil...
=================== 5 failed, 75 passed in 202.08s (0:03:22) ===================

Leaving build/test directories:
  Work:
 /Users/runner/conda/conda-bld/work 
  Test:
 /Users/runner/conda/conda-bld/test_tmp 
Leaving build/test environments:
  Test:
source activate  /Users/runner/conda/conda-bld/_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_pla 
  Build:
source activate  /Users/runner/conda/conda-bld/_build_env 


