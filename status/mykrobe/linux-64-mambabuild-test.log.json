  Package                    Version  Build                Channel                                    Size
────────────────────────────────────────────────────────────────────────────────────────────────────────────
  Install:
────────────────────────────────────────────────────────────────────────────────────────────────────────────

  + _libgcc_mutex                0.1  conda_forge          conda-forge/linux-64                     Cached
  + _openmp_mutex                4.5  1_gnu                conda-forge/linux-64                     Cached
  + abseil-cpp            20210324.2  h9c3ff4c_0           conda-forge/linux-64                    1010 KB
  + anytree                    2.8.0  pyh9f0ad1d_0         conda-forge/noarch                        31 KB
  + biopython                   1.79  py39h3811e60_0       conda-forge/linux-64                       3 MB
  + boost-cpp                 1.74.0  h312852a_4           conda-forge/linux-64                      16 MB
  + brotlipy                   0.7.0  py39h3811e60_1001    conda-forge/linux-64                     Cached
  + bzip2                      1.0.8  h7f98852_4           conda-forge/linux-64                     Cached
  + c-ares                    1.17.2  h7f98852_0           conda-forge/linux-64                     Cached
  + ca-certificates        2021.5.30  ha878542_0           conda-forge/linux-64                     Cached
  + certifi                2021.5.30  py39hf3d152e_0       conda-forge/linux-64                     Cached
  + cffi                      1.14.6  py39he32792d_0       conda-forge/linux-64                     Cached
  + chardet                    4.0.0  py39hf3d152e_1       conda-forge/linux-64                     Cached
  + charset-normalizer         2.0.0  pyhd8ed1ab_0         conda-forge/noarch                       Cached
  + cryptography               3.4.7  py39hbca0aa6_0       conda-forge/linux-64                     Cached
  + gettext                 0.19.8.1  h0b5b191_1005        conda-forge/linux-64                     Cached
  + icu                         68.1  h58526e2_0           conda-forge/linux-64                     Cached
  + idna                         3.1  pyhd3deb0d_0         conda-forge/noarch                       Cached
  + krb5                      1.19.2  hcc1bbae_0           conda-forge/linux-64                     Cached
  + ld_impl_linux-64          2.36.1  hea4e1c9_2           conda-forge/linux-64                     Cached
  + libblas                    3.9.0  11_linux64_openblas  conda-forge/linux-64                     Cached
  + libcblas                   3.9.0  11_linux64_openblas  conda-forge/linux-64                     Cached
  + libcurl                   7.78.0  h2574ce0_0           conda-forge/linux-64                     Cached
  + libedit             3.1.20191231  he28a2e2_2           conda-forge/linux-64                     Cached
  + libev                       4.33  h516909a_1           conda-forge/linux-64                     Cached
  + libffi                       3.3  h58526e2_2           conda-forge/linux-64                     Cached
  + libgcc-ng                 11.1.0  hc902ee8_8           conda-forge/linux-64                     Cached
  + libgfortran-ng            11.1.0  h69a702a_8           conda-forge/linux-64                     Cached
  + libgfortran5              11.1.0  h6c583b3_8           conda-forge/linux-64                     Cached
  + libgomp                   11.1.0  hc902ee8_8           conda-forge/linux-64                     Cached
  + libidn2                    2.3.2  h7f98852_0           conda-forge/linux-64                      98 KB
  + liblapack                  3.9.0  11_linux64_openblas  conda-forge/linux-64                     Cached
  + libnghttp2                1.43.0  h812cca2_0           conda-forge/linux-64                     Cached
  + libopenblas               0.3.17  pthreads_h8fe5266_1  conda-forge/linux-64                     Cached
  + libssh2                   1.10.0  ha56f1ee_0           conda-forge/linux-64                     Cached
  + libstdcxx-ng              11.1.0  h56837e0_8           conda-forge/linux-64                     Cached
  + libunistring              0.9.10  h7f98852_0           conda-forge/linux-64                       1 MB
  + lz4-c                      1.9.3  h9c3ff4c_1           conda-forge/linux-64                     Cached
  + mongodb                    5.0.2  h91ae487_0           conda-forge/linux-64                      68 MB
  + mongoengine               0.22.1  py39hf3d152e_0       conda-forge/linux-64                     160 KB
  + mykrobe                   0.10.0  py39h98c8e45_0       /home/vsts/conda/conda-bld/linux-64       14 MB
  + ncurses                      6.2  h58526e2_4           conda-forge/linux-64                     Cached
  + numpy                     1.21.2  py39hdbf815f_0       conda-forge/linux-64                       6 MB
  + openssl                   1.1.1k  h7f98852_1           conda-forge/linux-64                     Cached
  + pcre                        8.45  h9c3ff4c_0           conda-forge/linux-64                     Cached
  + pip                       21.2.4  pyhd8ed1ab_0         conda-forge/noarch                       Cached
  + pycparser                   2.20  pyh9f0ad1d_2         conda-forge/noarch                       Cached
  + pymongo                   3.12.0  py39he80948d_0       conda-forge/linux-64                       1 MB
  + pyopenssl                 20.0.1  pyhd8ed1ab_0         conda-forge/noarch                       Cached
  + pysocks                    1.7.1  py39hf3d152e_3       conda-forge/linux-64                     Cached
  + python                     3.9.6  h49503c6_1_cpython   conda-forge/linux-64                     Cached
  + python_abi                   3.9  2_cp39               conda-forge/linux-64                     Cached
  + pyvcf                      0.6.8  py39hde42818_1002    conda-forge/linux-64                      65 KB
  + readline                     8.1  h46c0cb4_0           conda-forge/linux-64                     Cached
  + requests                  2.26.0  pyhd8ed1ab_0         conda-forge/noarch                       Cached
  + setuptools                57.4.0  py39hf3d152e_0       conda-forge/linux-64                     Cached
  + six                       1.16.0  pyh6c4a22f_0         conda-forge/noarch                       Cached
  + snappy                     1.1.8  he1b5a44_3           conda-forge/linux-64                      32 KB
  + sqlite                    3.36.0  h9cd32fc_0           conda-forge/linux-64                     Cached
  + tk                        8.6.11  h21135ba_0           conda-forge/linux-64                     Cached
  + tzdata                     2021a  he74cb21_1           conda-forge/noarch                       Cached
  + urllib3                   1.26.6  pyhd8ed1ab_0         conda-forge/noarch                       Cached
  + wget                      1.20.3  ha56f1ee_0           conda-forge/linux-64                     808 KB
  + wheel                     0.37.0  pyhd8ed1ab_1         conda-forge/noarch                       Cached
  + xz                         5.2.5  h516909a_1           conda-forge/linux-64                     Cached
  + yaml-cpp                   0.6.3  he1b5a44_4           conda-forge/linux-64                     208 KB
  + zlib                      1.2.11  h516909a_1010        conda-forge/linux-64                     Cached
  + zstd                       1.5.0  ha95c52a_0           conda-forge/linux-64                     Cached

  Summary:

  Install: 68 packages

  Total download: 112 MB

────────────────────────────────────────────────────────────────────────────────────────────────────────────

Updating build index: /home/vsts/conda/conda-bld

TEST START: mykrobe-0.10.0-py39h98c8e45_0.tar.bz2

## Package Plan ##

  environment location: /home/vsts/conda/conda-bld/mykrobe_1630518730390/_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_plac


The following NEW packages will be INSTALLED:

    _libgcc_mutex:      0.1-conda_forge            conda-forge
    _openmp_mutex:      4.5-1_gnu                  conda-forge
    abseil-cpp:         20210324.2-h9c3ff4c_0      conda-forge
    anytree:            2.8.0-pyh9f0ad1d_0         conda-forge
    biopython:          1.79-py39h3811e60_0        conda-forge
    boost-cpp:          1.74.0-h312852a_4          conda-forge
    brotlipy:           0.7.0-py39h3811e60_1001    conda-forge
    bzip2:              1.0.8-h7f98852_4           conda-forge
    c-ares:             1.17.2-h7f98852_0          conda-forge
    ca-certificates:    2021.5.30-ha878542_0       conda-forge
    certifi:            2021.5.30-py39hf3d152e_0   conda-forge
    cffi:               1.14.6-py39he32792d_0      conda-forge
    chardet:            4.0.0-py39hf3d152e_1       conda-forge
    charset-normalizer: 2.0.0-pyhd8ed1ab_0         conda-forge
    cryptography:       3.4.7-py39hbca0aa6_0       conda-forge
    gettext:            0.19.8.1-h0b5b191_1005     conda-forge
    icu:                68.1-h58526e2_0            conda-forge
    idna:               3.1-pyhd3deb0d_0           conda-forge
    krb5:               1.19.2-hcc1bbae_0          conda-forge
    ld_impl_linux-64:   2.36.1-hea4e1c9_2          conda-forge
    libblas:            3.9.0-11_linux64_openblas  conda-forge
    libcblas:           3.9.0-11_linux64_openblas  conda-forge
    libcurl:            7.78.0-h2574ce0_0          conda-forge
    libedit:            3.1.20191231-he28a2e2_2    conda-forge
    libev:              4.33-h516909a_1            conda-forge
    libffi:             3.3-h58526e2_2             conda-forge
    libgcc-ng:          11.1.0-hc902ee8_8          conda-forge
    libgfortran-ng:     11.1.0-h69a702a_8          conda-forge
    libgfortran5:       11.1.0-h6c583b3_8          conda-forge
    libgomp:            11.1.0-hc902ee8_8          conda-forge
    libidn2:            2.3.2-h7f98852_0           conda-forge
    liblapack:          3.9.0-11_linux64_openblas  conda-forge
    libnghttp2:         1.43.0-h812cca2_0          conda-forge
    libopenblas:        0.3.17-pthreads_h8fe5266_1 conda-forge
    libssh2:            1.10.0-ha56f1ee_0          conda-forge
    libstdcxx-ng:       11.1.0-h56837e0_8          conda-forge
    libunistring:       0.9.10-h7f98852_0          conda-forge
    lz4-c:              1.9.3-h9c3ff4c_1           conda-forge
    mongodb:            5.0.2-h91ae487_0           conda-forge
    mongoengine:        0.22.1-py39hf3d152e_0      conda-forge
    mykrobe:            0.10.0-py39h98c8e45_0      local      
    ncurses:            6.2-h58526e2_4             conda-forge
    numpy:              1.21.2-py39hdbf815f_0      conda-forge
    openssl:            1.1.1k-h7f98852_1          conda-forge
    pcre:               8.45-h9c3ff4c_0            conda-forge
    pip:                21.2.4-pyhd8ed1ab_0        conda-forge
    pycparser:          2.20-pyh9f0ad1d_2          conda-forge
    pymongo:            3.12.0-py39he80948d_0      conda-forge
    pyopenssl:          20.0.1-pyhd8ed1ab_0        conda-forge
    pysocks:            1.7.1-py39hf3d152e_3       conda-forge
    python:             3.9.6-h49503c6_1_cpython   conda-forge
    python_abi:         3.9-2_cp39                 conda-forge
    pyvcf:              0.6.8-py39hde42818_1002    conda-forge
    readline:           8.1-h46c0cb4_0             conda-forge
    requests:           2.26.0-pyhd8ed1ab_0        conda-forge
    setuptools:         57.4.0-py39hf3d152e_0      conda-forge
    six:                1.16.0-pyh6c4a22f_0        conda-forge
    snappy:             1.1.8-he1b5a44_3           conda-forge
    sqlite:             3.36.0-h9cd32fc_0          conda-forge
    tk:                 8.6.11-h21135ba_0          conda-forge
    tzdata:             2021a-he74cb21_1           conda-forge
    urllib3:            1.26.6-pyhd8ed1ab_0        conda-forge
    wget:               1.20.3-ha56f1ee_0          conda-forge
    wheel:              0.37.0-pyhd8ed1ab_1        conda-forge
    xz:                 5.2.5-h516909a_1           conda-forge
    yaml-cpp:           0.6.3-he1b5a44_4           conda-forge
    zlib:               1.2.11-h516909a_1010       conda-forge
    zstd:               1.5.0-ha95c52a_0           conda-forge

Preparing transaction: ...working... done
Verifying transaction: ...working... done
Executing transaction: ...working... done
export PREFIX=/home/vsts/conda/conda-bld/mykrobe_1630518730390/_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_plac
export SRC_DIR=/home/vsts/conda/conda-bld/mykrobe_1630518730390/test_tmp
import: 'mykrobe'
import: 'mykrobe'
mykrobe v0.10.0
usage: mykrobe [-h] [--version] {predict,panels,variants,vars} ...

optional arguments:
  -h, --help            show this help message and exit
  --version             mykrobe version

[sub-commands]:
  {predict,panels,variants,vars}
    predict             Predict the sample's drug susceptibility
    panels              Add, update, or remove panels
    variants (vars)     build variant probes
usage: mykrobe predict [-h] -s SAMPLE [-k kmer] [--tmp TMP] [--keep_tmp]
                       [--skeleton_dir SKELETON_DIR] [-t THREADS] [-m MEMORY]
                       [--expected_depth EXPECTED_DEPTH] [-1 seq [seq ...]]
                       [-c ctx] [-f] [--ont] [--guess_sequence_method]
                       [--ignore_minor_calls]
                       [--ignore_filtered IGNORE_FILTERED] [--model model]
                       [--ploidy ploidy] [--filters FILTERS [FILTERS ...]]
                       [-A] [-e EXPECTED_ERROR_RATE]
                       [--min_variant_conf MIN_VARIANT_CONF]
                       [--min_gene_conf MIN_GENE_CONF]
                       [--min_proportion_expected_depth MIN_PROPORTION_EXPECTED_DEPTH]
                       [--min_gene_percent_covg_threshold MIN_GENE_PERCENT_COVG_THRESHOLD]
                       [-o OUTPUT] [--panels_dir DIRNAME] [-q] [-d] -S species
                       [--panel panel] [--custom_probe_set_path FILENAME]
                       [--custom_variant_to_resistance_json FILENAME]
                       [--custom_lineage_json FILENAME]
                       [--min_depth min_depth]
                       [--conf_percent_cutoff conf_percent_cutoff]
                       [--format {json,csv,json_and_csv}]

optional arguments:
  -h, --help            show this help message and exit
  -s SAMPLE, --sample SAMPLE
                        Sample identifier [REQUIRED]
  -k kmer, --kmer kmer  K-mer length (default: 21)
  --tmp TMP             Directory to write temporary files to
  --keep_tmp            Don't remove temporary files
  --skeleton_dir SKELETON_DIR
                        Directory for skeleton binaries
  -t THREADS, --threads THREADS
                        Number of threads to use
  -m MEMORY, --memory MEMORY
                        Memory to allocate for graph constuction (default:
                        1GB)
  --expected_depth EXPECTED_DEPTH
                        Expected depth
  -1 seq [seq ...], -i seq [seq ...], --seq seq [seq ...]
                        Sequence files (fasta,fastq,bam)
  -c ctx, --ctx ctx     Cortex graph binary
  -f, --force           Force override any skeleton files
  --ont                 Set default for ONT data. Sets expected_error_rate to
                        0.15 and to haploid
  --guess_sequence_method
                        Guess if ONT or Illumia based on error rate. If error
                        rate is > 10%, ploidy is set to haploid and a
                        confidence threshold is used
  --ignore_minor_calls  Ignore minor calls when running resistance prediction
  --ignore_filtered IGNORE_FILTERED
                        Don't include filtered genotypes
  --model model         Genotype model used. Options kmer_count, median_depth
                        (default: kmer_count)
  --ploidy ploidy       Use a diploid (includes 0/1 calls) or haploid
                        genotyping model (default: diploid)
  --filters FILTERS [FILTERS ...]
                        Don't include specific filtered genotypes (default:
                        ['MISSING_WT', 'LOW_PERCENT_COVERAGE', 'LOW_GT_CONF',
                        'LOW_TOTAL_DEPTH'])
  -A, --report_all_calls
                        Report all calls
  -e EXPECTED_ERROR_RATE, --expected_error_rate EXPECTED_ERROR_RATE
                        Expected sequencing error rate (default: 0.05)
  --min_variant_conf MIN_VARIANT_CONF
                        Minimum genotype confidence for variant genotyping
                        (default: 150)
  --min_gene_conf MIN_GENE_CONF
                        Minimum genotype confidence for gene genotyping
                        (default: 1)
  --min_proportion_expected_depth MIN_PROPORTION_EXPECTED_DEPTH
                        Minimum depth required on the sum of both alleles
                        (default: 0.30)
  --min_gene_percent_covg_threshold MIN_GENE_PERCENT_COVG_THRESHOLD
                        All genes alleles found above this percent coverage
                        will be reported (default: 100 (only best alleles
                        reported))
  -o OUTPUT, --output OUTPUT
                        File path to save output json file as. Default is to
                        stdout
  --panels_dir DIRNAME  Name of directory that contains panel data (default:
                        /home/vsts/conda/conda-bld/mykrobe_1630518730390/_test
                        _env_placehold_placehold_placehold_placehold_placehold
                        _placehold_placehold_placehold_placehold_placehold_pla
                        cehold_placehold_placehold_placehold_placehold_placeho
                        ld_placehold_placehold_placehold_plac/lib/python3.9/si
                        te-packages/mykrobe/data)
  -q, --quiet           Only output warnings/errors to stderr
  -d, --debug           Output debugging information to stderr
  -S species, --species species
                        Species name, or 'custom' to use custom data, in which
                        case --custom_probe_set_path is required. Run `mykrobe
                        panels describe` to see list of options [REQUIRED]
  --panel panel         Name of panel to use. Ignored if species is 'custom'.
                        Run `mykrobe panels describe` to see list of options
  --custom_probe_set_path FILENAME
                        Required if species is 'custom'. Ignored otherwise.
                        File path to fasta file from `mykrobe make-probes`.
  --custom_variant_to_resistance_json FILENAME
                        For use with `--panel custom`. Ignored otherwise. File
                        path to JSON with key,value pairs of variant names and
                        induced drug resistance.
  --custom_lineage_json FILENAME
                        For use with `--panel custom`. Ignored otherwise. File
                        path to JSON made by --lineage option of make-probes
  --min_depth min_depth
                        Minimum depth (default: 1)
  --conf_percent_cutoff conf_percent_cutoff
                        Number between 0 and 100. Determines
                        --min_variant_conf, by simulating variants and
                        choosing the cutoff that would keep x% of the
                        variants. Default is 90 if --ont, otherwise
                        --min_variant_conf is used as the cutoff
  --format {json,csv,json_and_csv}
                        Choose output format (default: csv)
usage: mykrobe variants [-h] [-q] [-d] {add,dump-probes,make-probes} ...

optional arguments:
  -h, --help            show this help message and exit
  -q, --quiet           Only output warnings/errors to stderr
  -d, --debug           Output debugging information to stderr

[sub-commands]:
  {add,dump-probes,make-probes}
                        help
    add                 adds a set of variants to the database
    dump-probes         dump a probe set of variant alleles from VCFs stored
                        in database
    make-probes         make probes from a list of variants
Gathering data from $PREFIX/lib/python3.9/site-packages/mykrobe/data

Species summary:

Species	Update_available	Installed_version	Installed_url	Latest_version	Latest_url
sonnei	no	20210201	https://ndownloader.figshare.com/files/26274424	20210201	https://ndownloader.figshare.com/files/26274424
staph	no	20201001	https://ndownloader.figshare.com/files/24914930	20201001	https://ndownloader.figshare.com/files/24914930
tb	no	20201014	https://ndownloader.figshare.com/files/25103438	20201014	https://ndownloader.figshare.com/files/25103438
typhi	no	20210323	https://ndownloader.figshare.com/files/28533549	20210323	https://ndownloader.figshare.com/files/28533549

sonnei default panel: 20210201
sonnei panels:
Panel	Reference	Description
20201012	NC_016822.1	Genotyping panel for Shigella sonnei based on scheme defined in Hawkey 2020, and panel for variants in the quinolone resistance determining regions in gyrA and parC
20210201	NC_016822.1	Genotyping panel for Shigella sonnei based on scheme defined in Hawkey 2020, and panel for variants in the quinolone resistance determining regions in gyrA and parC (same as 20201012, but with lineage3.7.30 added)

staph default panel: 20170217
staph panels:
Panel	Reference	Description
20170217	BX571856.1	AMR panel described in Bradley, P et al. Rapid antibiotic-resistance predictions from genome sequence data for Staphylococcus aureus and Mycobacterium tuberculosis. Nat. Commun. 6:10063 doi: 10.1038/ncomms10063 (2015)

tb default panel: 202010
tb panels:
Panel	Reference	Description
201901	NC_000962.3	AMR panel based on first line drugs from NEJM-2018 variants (DOI 10.1056/NEJMoa1800474), and second line drugs from Walker 2015 panel
202010	NC_000962.3	AMR panel based on first line drugs from NEJM-2018 variants (DOI 10.1056/NEJMoa1800474), second line drugs from Walker 2015 panel, and lineage scheme from Chiner-Oms 2020
bradley-2015	NC_000962.3	AMR panel described in Bradley, P et al. Rapid antibiotic-resistance predictions from genome sequence data for Staphylococcus aureus and Mycobacterium tuberculosis. Nat. Commun. 6:10063 doi: 10.1038/ncomms10063 (2015)
walker-2015	NC_000962.3	AMR panel described in Walker, Timothy M et al. Whole-genome sequencing for prediction of Mycobacterium tuberculosis drug susceptibility and resistance: a retrospective cohort study. The Lancet Infectious Diseases , Volume 15 , Issue 10 , 1193 - 1202

typhi default panel: 20210323
typhi panels:
Panel	Reference	Description
20210323	AL513382.1	GenoTyphi genotyping scheme and AMR calling using Wong et al 2016 (https://doi.org/10.1038/ncomms12827) and updates as described in Dyson & Holt 2021 (https://doi.org/10.1101/2021.04.28.441766)
>>kmer0
GAATAGA

Resource usage statistics from testing mykrobe:
   Process count: 1
   CPU time: Sys=0:00:00.0, User=-
   Memory: 3.3M
   Disk usage: 20B
   Time elapsed: 0:00:02.1


TEST END: mykrobe-0.10.0-py39h98c8e45_0.tar.bz2
--dirty flag and --keep-old-work not specified. Removing build/test folder after successful build/test.

