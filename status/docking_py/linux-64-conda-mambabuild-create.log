Updating build index: /home/vsts/conda/conda-bld

TEST START: /tmp/tmp0ib9pchx/noarch/docking_py-0.2.3-py_0.tar.bz2
Adding in variants from internal_defaults
Adding in variants from /tmp/tmp2qzwqoj2/info/recipe/conda_build_config.yaml
Reloading output folder: /home/vsts/conda/conda-bld

## Package Plan ##

  environment location: /home/vsts/conda/conda-bld/docking_py_1635994579437/_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_p


The following NEW packages will be INSTALLED:

    _libgcc_mutex:             0.1-conda_forge            conda-forge            
    _openmp_mutex:             4.5-1_gnu                  conda-forge            
    attrs:                     21.2.0-pyhd8ed1ab_0        conda-forge            
    autodock-vina:             1.1.2-h9ee0642_3           bioconda               
    boost-cpp:                 1.74.0-h359cf19_5          conda-forge            
    brotlipy:                  0.7.0-py39h3811e60_1002    conda-forge            
    bzip2:                     1.0.8-h7f98852_4           conda-forge            
    ca-certificates:           2021.10.8-ha878542_0       conda-forge            
    cairo:                     1.16.0-ha00ac49_1009       conda-forge            
    certifi:                   2021.10.8-py39hf3d152e_1   conda-forge            
    cffi:                      1.14.6-py39h4bc2ebd_2      conda-forge            
    chardet:                   4.0.0-py39hf3d152e_2       conda-forge            
    charset-normalizer:        2.0.0-pyhd8ed1ab_0         conda-forge            
    cryptography:              35.0.0-py39h95dcef6_1      conda-forge            
    docking_py:                0.2.3-py_0                 file:///tmp/tmp0ib9pchx
    font-ttf-dejavu-sans-mono: 2.37-hab24e00_0            conda-forge            
    font-ttf-inconsolata:      3.000-h77eed37_0           conda-forge            
    font-ttf-source-code-pro:  2.038-h77eed37_0           conda-forge            
    font-ttf-ubuntu:           0.83-hab24e00_0            conda-forge            
    fontconfig:                2.13.1-hba837de_1005       conda-forge            
    fonts-conda-ecosystem:     1-0                        conda-forge            
    fonts-conda-forge:         1-0                        conda-forge            
    freetype:                  2.10.4-h0708190_1          conda-forge            
    gettext:                   0.19.8.1-h73d1719_1008     conda-forge            
    icu:                       69.1-h9c3ff4c_0            conda-forge            
    idna:                      3.1-pyhd3deb0d_0           conda-forge            
    iniconfig:                 1.1.1-pyh9f0ad1d_0         conda-forge            
    ld_impl_linux-64:          2.36.1-hea4e1c9_2          conda-forge            
    libblas:                   3.9.0-12_linux64_openblas  conda-forge            
    libcblas:                  3.9.0-12_linux64_openblas  conda-forge            
    libffi:                    3.4.2-h9c3ff4c_4           conda-forge            
    libgcc-ng:                 11.2.0-h1d223b6_11         conda-forge            
    libgfortran-ng:            11.2.0-h69a702a_11         conda-forge            
    libgfortran5:              11.2.0-h5c6108e_11         conda-forge            
    libglib:                   2.70.0-h174f98d_1          conda-forge            
    libgomp:                   11.2.0-h1d223b6_11         conda-forge            
    libiconv:                  1.16-h516909a_0            conda-forge            
    liblapack:                 3.9.0-12_linux64_openblas  conda-forge            
    libopenblas:               0.3.18-pthreads_h8fe5266_0 conda-forge            
    libpng:                    1.6.37-h21135ba_2          conda-forge            
    libstdcxx-ng:              11.2.0-he4da1e4_11         conda-forge            
    libuuid:                   2.32.1-h7f98852_1000       conda-forge            
    libxcb:                    1.13-h7f98852_1003         conda-forge            
    libxml2:                   2.9.12-h885dcf4_1          conda-forge            
    libzlib:                   1.2.11-h36c2ea0_1013       conda-forge            
    lz4-c:                     1.9.3-h9c3ff4c_1           conda-forge            
    mgltools:                  1.5.6-1                    bioconda               
    mmcif_pdbx:                2.0.0-pyh44b312d_0         conda-forge            
    more-itertools:            8.10.0-pyhd8ed1ab_0        conda-forge            
    ncurses:                   6.2-h58526e2_4             conda-forge            
    numpy:                     1.21.3-py39hdbf815f_1      conda-forge            
    openbabel:                 3.1.1-py39hee2736e_3       conda-forge            
    openssl:                   1.1.1l-h7f98852_0          conda-forge            
    os_command_py:             1.1.0-py_0                 conda-forge            
    packaging:                 21.2-pyhd8ed1ab_1          conda-forge            
    pandas:                    1.3.4-py39hde0f152_0       conda-forge            
    pcre:                      8.45-h9c3ff4c_0            conda-forge            
    pdb2pqr:                   3.2.0-pyhd8ed1ab_0         conda-forge            
    pdb2pqr_htmd_propka30:     0.0.4-py_0                 conda-forge            
    pdb_manip_py:              1.4.1-pyhd8ed1ab_0         conda-forge            
    pip:                       21.3.1-pyhd8ed1ab_0        conda-forge            
    pixman:                    0.40.0-h36c2ea0_0          conda-forge            
    pluggy:                    1.0.0-py39hf3d152e_2       conda-forge            
    propka:                    3.4.0-py39hef51801_1       conda-forge            
    pthread-stubs:             0.4-h36c2ea0_1001          conda-forge            
    py:                        1.10.0-pyhd3deb0d_0        conda-forge            
    pycparser:                 2.20-pyh9f0ad1d_2          conda-forge            
    pyopenssl:                 21.0.0-pyhd8ed1ab_0        conda-forge            
    pyparsing:                 2.4.7-pyhd8ed1ab_1         conda-forge            
    pysocks:                   1.7.1-py39hf3d152e_4       conda-forge            
    pytest:                    6.2.5-py39hf3d152e_1       conda-forge            
    python:                    3.9.7-hb7a2778_3_cpython   conda-forge            
    python-dateutil:           2.8.2-pyhd8ed1ab_0         conda-forge            
    python_abi:                3.9-2_cp39                 conda-forge            
    pytz:                      2021.3-pyhd8ed1ab_0        conda-forge            
    qvina:                     2.1.0-h62396cd_2           conda-forge            
    readline:                  8.1-h46c0cb4_0             conda-forge            
    requests:                  2.26.0-pyhd8ed1ab_0        conda-forge            
    scipy:                     1.7.1-py39hee8e79c_0       conda-forge            
    setuptools:                58.4.0-py39hf3d152e_1      conda-forge            
    six:                       1.16.0-pyh6c4a22f_0        conda-forge            
    smina:                     2020.12.10-h37f9cb6_0      conda-forge            
    sqlite:                    3.36.0-h9cd32fc_2          conda-forge            
    tk:                        8.6.11-h27826a3_1          conda-forge            
    toml:                      0.10.2-pyhd8ed1ab_0        conda-forge            
    tzdata:                    2021e-he74cb21_0           conda-forge            
    urllib3:                   1.26.7-pyhd8ed1ab_0        conda-forge            
    wheel:                     0.37.0-pyhd8ed1ab_1        conda-forge            
    xorg-kbproto:              1.0.7-h7f98852_1002        conda-forge            
    xorg-libice:               1.0.10-h7f98852_0          conda-forge            
    xorg-libsm:                1.2.3-hd9c2040_1000        conda-forge            
    xorg-libx11:               1.7.2-h7f98852_0           conda-forge            
    xorg-libxau:               1.0.9-h7f98852_0           conda-forge            
    xorg-libxdmcp:             1.1.3-h7f98852_0           conda-forge            
    xorg-libxext:              1.3.4-h7f98852_1           conda-forge            
    xorg-libxrender:           0.9.10-h7f98852_1003       conda-forge            
    xorg-renderproto:          0.11.1-h7f98852_1002       conda-forge            
    xorg-xextproto:            7.3.0-h7f98852_1002        conda-forge            
    xorg-xproto:               7.0.31-h7f98852_1007       conda-forge            
    xz:                        5.2.5-h516909a_1           conda-forge            
    zlib:                      1.2.11-h36c2ea0_1013       conda-forge            
    zstd:                      1.5.0-ha95c52a_0           conda-forge            

Preparing transaction: ...working... done
Verifying transaction: ...working... done
Executing transaction: ...working... done
export PREFIX=/home/vsts/conda/conda-bld/docking_py_1635994579437/_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_p
export SRC_DIR=/home/vsts/conda/conda-bld/docking_py_1635994579437/test_tmp
import: 'docking_py.docking'
Smina ligand script is $PREFIX/bin/prepare_ligand4.py
Smina receptor script is $PREFIX/bin/prepare_receptor4.py
Smina grid script is $PREFIX/MGLToolsPckgs/AutoDockTools/Utilities24/prepare_gpf4.py
Python Smina is $PREFIX/bin/python2.5
Smina executable is $PREFIX/bin/smina
Vina executable is $PREFIX/bin/vina
Vina executable is $PREFIX/bin/vina
Vina executable is $PREFIX/bin/vina
import: 'docking_py.docking'
============================= test session starts ==============================
platform linux -- Python 3.9.7, pytest-6.2.5, py-1.10.0, pluggy-1.0.0
rootdir: $SRC_DIR
collected 11 items

docking.py FFFFFFF                                                       [ 63%]
tests/test_docking_py.py .FFF                                            [100%]

=================================== FAILURES ===================================
_____________ [doctest] docking_py.docking.Docking.align_receptor ______________
724 
725         Align self.rec_pdb to ref_pdb.
726 
727         :Example:
728 
729         >>> TEST_OUT = str(getfixture('tmpdir'))
730         >>> dock_4yob = Docking(name='4yob')
731         >>> dock_4yob.extract_receptor(os.path.join(TEST_PATH, '4yob.pdb'),        TEST_OUT, {'res_name': pdb_manip.PROTEIN_AA})        #doctest: +ELLIPSIS
UNEXPECTED EXCEPTION: AttributeError("module 'pdb_manip_py.pdb_manip' has no attribute 'PROTEIN_AA'")
Traceback (most recent call last):
  File "$PREFIX/lib/python3.9/doctest.py", line 1336, in __run
    exec(compile(example.source, filename, "single",
  File "<doctest docking_py.docking.Docking.align_receptor[2]>", line 1, in <module>
AttributeError: module 'pdb_manip_py.pdb_manip' has no attribute 'PROTEIN_AA'
$PREFIX/lib/python3.9/site-packages/docking_py/docking.py:731: UnexpectedException
___________ [doctest] docking_py.docking.Docking.extract_lig_rec_pdb ___________
610         **Object field(s) changed:**
611 
612             * self.rec_pdb
613             * self.lig_pdb
614 
615         :Example:
616 
617         >>> TEST_OUT = str(getfixture('tmpdir'))
618         >>> dock_1hsg = Docking(name='1hsg')
619         >>> dock_1hsg.extract_lig_rec_pdb(os.path.join(TEST_PATH, '1hsg.pdb'),        TEST_OUT, {'res_name': pdb_manip.PROTEIN_AA}, {'res_name': 'MK1'})        #doctest: +ELLIPSIS
UNEXPECTED EXCEPTION: AttributeError("module 'pdb_manip_py.pdb_manip' has no attribute 'PROTEIN_AA'")
Traceback (most recent call last):
  File "$PREFIX/lib/python3.9/doctest.py", line 1336, in __run
    exec(compile(example.source, filename, "single",
  File "<doctest docking_py.docking.Docking.extract_lig_rec_pdb[2]>", line 1, in <module>
AttributeError: module 'pdb_manip_py.pdb_manip' has no attribute 'PROTEIN_AA'
$PREFIX/lib/python3.9/site-packages/docking_py/docking.py:619: UnexpectedException
_____________ [doctest] docking_py.docking.Docking.extract_ligand ______________
785 
786         **Object field(s) changed:**
787 
788             * self.lig_pdb
789 
790         :Example:
791 
792         >>> TEST_OUT = str(getfixture('tmpdir'))
793         >>> dock_1hsg = Docking(name='1hsg')
794         >>> dock_1hsg.extract_ligand(os.path.join(TEST_PATH, '1hsg.pdb'),        TEST_OUT, {'res_name': 'MK1'})        #doctest: +ELLIPSIS
Expected:
    Succeed to read file ...1hsg.pdb ,  1686 atoms found
    Succeed to save file ...1hsg_lig.pdb
Got nothing

$PREFIX/lib/python3.9/site-packages/docking_py/docking.py:794: DocTestFailure
____________ [doctest] docking_py.docking.Docking.extract_receptor _____________
686 
687         **Object field(s) changed:**
688 
689             * self.rec_pdb
690 
691         :Example:
692 
693         >>> TEST_OUT = str(getfixture('tmpdir'))
694         >>> dock_1hsg = Docking(name='1hsg')
695         >>> dock_1hsg.extract_receptor(os.path.join(TEST_PATH, '1hsg.pdb'),        TEST_OUT, {'res_name': pdb_manip.PROTEIN_AA})        #doctest: +ELLIPSIS
UNEXPECTED EXCEPTION: AttributeError("module 'pdb_manip_py.pdb_manip' has no attribute 'PROTEIN_AA'")
Traceback (most recent call last):
  File "$PREFIX/lib/python3.9/doctest.py", line 1336, in __run
    exec(compile(example.source, filename, "single",
  File "<doctest docking_py.docking.Docking.extract_receptor[2]>", line 1, in <module>
AttributeError: module 'pdb_manip_py.pdb_manip' has no attribute 'PROTEIN_AA'
$PREFIX/lib/python3.9/site-packages/docking_py/docking.py:695: UnexpectedException
_____________ [doctest] docking_py.docking.Docking.prepare_ligand ______________
214             * self.lig_pdb
215 
216         **Object field(s) changed:**
217 
218             * self.lig_pdbqt
219 
220         :Example:
221 
222         >>> TEST_OUT = str(getfixture('tmpdir'))
223         >>> coor_1hsg = pdb_manip.Coor(os.path.join(TEST_PATH, '1hsg.pdb'))        #doctest: +ELLIPSIS
Expected:
    Succeed to read file ...tests/input/1hsg.pdb ,  1686 atoms found
Got nothing

$PREFIX/lib/python3.9/site-packages/docking_py/docking.py:223: DocTestFailure
____________ [doctest] docking_py.docking.Docking.prepare_receptor _____________
281             * self.rec_pdb
282 
283         **Object field(s) changed:**
284 
285             * self.rec_pdbqt
286 
287         :Example:
288 
289         >>> TEST_OUT = str(getfixture('tmpdir'))
290         >>> coor_1hsg = pdb_manip.Coor(os.path.join(TEST_PATH, '1hsg.pdb'))        #doctest: +ELLIPSIS
Expected:
    Succeed to read file .../1hsg.pdb ,  1686 atoms found
Got nothing

$PREFIX/lib/python3.9/site-packages/docking_py/docking.py:290: DocTestFailure
____________ [doctest] docking_py.docking.Docking.random_rot_ligand ____________
825 
826         **Object field(s) changed:**
827 
828             * self.lig_pdb
829 
830         :Example:
831 
832         >>> TEST_OUT = str(getfixture('tmpdir'))
833         >>> dock_1hsg = Docking(name='1hsg')
834         >>> dock_1hsg.extract_ligand(os.path.join(TEST_PATH, '1hsg.pdb'),        TEST_OUT, {'res_name': 'MK1'})        #doctest: +ELLIPSIS
Expected:
    Succeed to read file ...1hsg.pdb ,  1686 atoms found
    Succeed to save file ...1hsg_lig.pdb
Got nothing

$PREFIX/lib/python3.9/site-packages/docking_py/docking.py:834: DocTestFailure
_________________________ test_prepare_ligand_recetor __________________________

tmp_path = PosixPath('/tmp/pytest-of-vsts/pytest-0/test_prepare_ligand_recetor0')
capsys = <_pytest.capture.CaptureFixture object at 0x7f0cce5119d0>

    def test_prepare_ligand_recetor(tmp_path, capsys):
    
        # Convert to str to avoid problem with python 3.5
        TEST_OUT = str(tmp_path)
    
        # Read 1hsg.pdb, extract lig.pdb and rec.pdb
        coor_1hsg = pdb_manip.Coor(os.path.join(TEST_PATH, '1hsg.pdb'))
    
        captured = capsys.readouterr()
>       assert bool(
            re.match("Succeed to read file .+input/1hsg.pdb ,  1686 atoms found\n",
                     captured.out))
E       AssertionError: assert False
E        +  where False = bool(None)
E        +    where None = <function match at 0x7f0cdc8b1310>('Succeed to read file .+input/1hsg.pdb ,  1686 atoms found\n', '')
E        +      where <function match at 0x7f0cdc8b1310> = re.match
E        +      and   '' = CaptureResult(out='', err='').out

../_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_p/lib/python3.9/site-packages/docking_py/tests/test_docking_py.py:43: AssertionError
_______________________________ test_smina_rigid _______________________________

tmp_path = PosixPath('/tmp/pytest-of-vsts/pytest-0/test_smina_rigid0')
capsys = <_pytest.capture.CaptureFixture object at 0x7f0cce538580>

    def test_smina_rigid(tmp_path, capsys):
    
        # Convert to str to avoid problem with python 3.5
        TEST_OUT = str(tmp_path)
    
        # Extract center and max_sizer:
        lig_coor = pdb_manip.Coor(os.path.join(TEST_PATH, 'lig.pdbqt'))
    
        center_lig = lig_coor.center_of_mass()
        max_size = lig_coor.get_max_size()
        print("Center coordinates is {:.1f} {:.1f} {:.1f}, maximum dimension"
              " is {:.1f} Å".format(*center_lig, max_size))
    
        captured = capsys.readouterr()
>       assert bool(re.match('Succeed to read file .+/input/lig.pdbqt ,  50 '
                             'atoms found\nDo a rotation of 99.71°\nCenter '
                             'coordinates is 13.1 22.5 5.5, maximum dimension is '
                             '18.0 Å\n',
                    captured.out))
E       AssertionError: assert False
E        +  where False = bool(None)
E        +    where None = <function match at 0x7f0cdc8b1310>('Succeed to read file .+/input/lig.pdbqt ,  50 atoms found\nDo a rotation of 99.71°\nCenter coordinates is 13.1 22.5 5.5, maximum dimension is 18.0 Å\n', 'Center coordinates is 13.1 22.5 5.5, maximum dimension is 18.0 Å\n')
E        +      where <function match at 0x7f0cdc8b1310> = re.match
E        +      and   'Center coordinates is 13.1 22.5 5.5, maximum dimension is 18.0 Å\n' = CaptureResult(out='Center coordinates is 13.1 22.5 5.5, maximum dimension is 18.0 Å\n', err='').out

../_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_p/lib/python3.9/site-packages/docking_py/tests/test_docking_py.py:137: AssertionError
------------------------------ Captured log call -------------------------------
WARNING  pdb_manip_py.pdb_manip:pdb_manip.py:823 File name doesn't finish with .pdb read it as .pdb anyway
_______________________________ test_vina_rigid ________________________________

tmp_path = PosixPath('/tmp/pytest-of-vsts/pytest-0/test_vina_rigid0')
capsys = <_pytest.capture.CaptureFixture object at 0x7f0cce5368b0>

    def test_vina_rigid(tmp_path, capsys):
    
        # Convert to str to avoid problem with python 3.5
        TEST_OUT = str(tmp_path)
    
        # Extract center and max_sizer:
        lig_coor = pdb_manip.Coor(os.path.join(TEST_PATH, 'lig.pdbqt'))
    
        center_lig = lig_coor.center_of_mass()
        max_size = lig_coor.get_max_size()
        print("Center coordinates is {:.1f} {:.1f} {:.1f}, maximum dimension"
              " is {:.1f} Å".format(*center_lig, max_size))
    
        captured = capsys.readouterr()
>       assert bool(re.match('Succeed to read file .+/input/lig.pdbqt ,  50 '
                             'atoms found\nDo a rotation of 99.71°\nCenter '
                             'coordinates is 13.1 22.5 5.5, maximum dimension is '
                             '18.0 Å\n',
                    captured.out))
E       AssertionError: assert False
E        +  where False = bool(None)
E        +    where None = <function match at 0x7f0cdc8b1310>('Succeed to read file .+/input/lig.pdbqt ,  50 atoms found\nDo a rotation of 99.71°\nCenter coordinates is 13.1 22.5 5.5, maximum dimension is 18.0 Å\n', 'Center coordinates is 13.1 22.5 5.5, maximum dimension is 18.0 Å\n')
E        +      where <function match at 0x7f0cdc8b1310> = re.match
E        +      and   'Center coordinates is 13.1 22.5 5.5, maximum dimension is 18.0 Å\n' = CaptureResult(out='Center coordinates is 13.1 22.5 5.5, maximum dimension is 18.0 Å\n', err='').out

../_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_p/lib/python3.9/site-packages/docking_py/tests/test_docking_py.py:194: AssertionError
------------------------------ Captured log call -------------------------------
WARNING  pdb_manip_py.pdb_manip:pdb_manip.py:823 File name doesn't finish with .pdb read it as .pdb anyway
=============================== warnings summary ===============================
tests/test_docking_py.py::test_smina_rigid
tests/test_docking_py.py::test_vina_rigid
  $PREFIX/lib/python3.9/site-packages/pdb_manip_py/pdb_manip.py:3279: UserWarning: Optimal rotation is not uniquely or poorly defined for the given sets of vectors.
    r, rmsd = Rotation.align_vectors(

-- Docs: https://docs.pytest.org/en/stable/warnings.html
=========================== short test summary info ============================
FAILED docking.py::docking_py.docking.Docking.align_receptor
FAILED docking.py::docking_py.docking.Docking.extract_lig_rec_pdb
FAILED docking.py::docking_py.docking.Docking.extract_ligand
FAILED docking.py::docking_py.docking.Docking.extract_receptor
FAILED docking.py::docking_py.docking.Docking.prepare_ligand
FAILED docking.py::docking_py.docking.Docking.prepare_receptor
FAILED docking.py::docking_py.docking.Docking.random_rot_ligand
FAILED tests/test_docking_py.py::test_prepare_ligand_recetor - AssertionError...
FAILED tests/test_docking_py.py::test_smina_rigid - AssertionError: assert False
FAILED tests/test_docking_py.py::test_vina_rigid - AssertionError: assert False
=================== 10 failed, 1 passed, 2 warnings in 0.39s ===================

Leaving build/test directories:
  Work:
 /home/vsts/conda/conda-bld/work 
  Test:
 /home/vsts/conda/conda-bld/test_tmp 
Leaving build/test environments:
  Test:
source activate  /home/vsts/conda/conda-bld/_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placeh 
  Build:
source activate  /home/vsts/conda/conda-bld/_build_env 


