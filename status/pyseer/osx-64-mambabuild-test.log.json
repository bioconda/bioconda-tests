  Package                 Version  Build               Channel                                    Size
────────────────────────────────────────────────────────────────────────────────────────────────────────
  Install:
────────────────────────────────────────────────────────────────────────────────────────────────────────

  + bedops                 2.4.39  h770b8ee_0          bioconda/osx-64                           11 MB
  + bedtools               2.30.0  haa7f73a_2          bioconda/osx-64                          807 KB
  + bwa                    0.7.17  h188c3c3_8          bioconda/osx-64                          208 KB
  + bzip2                   1.0.8  h0d85af4_4          conda-forge/osx-64                       Cached
  + c-ares                 1.17.2  h0d85af4_0          conda-forge/osx-64                       Cached
  + ca-certificates     2021.5.30  h033912b_0          conda-forge/osx-64                       Cached
  + capnproto               0.6.1  h0ceac7d_2          conda-forge/osx-64                         2 MB
  + certifi             2021.5.30  py39h6e9494a_0      conda-forge/osx-64                       Cached
  + colorama                0.4.4  pyh9f0ad1d_0        conda-forge/noarch                       Cached
  + cycler                 0.10.0  py_2                conda-forge/noarch                         9 KB
  + dendropy                4.5.2  pyh3252c3a_0        bioconda/noarch                          308 KB
  + freetype               2.10.4  h4cff582_1          conda-forge/osx-64                       Cached
  + glmnet_py               1.0.2  py39hac8ec06_4      conda-forge/osx-64                       159 KB
  + gsl                       2.6  h71c5fe9_2          conda-forge/osx-64                         3 MB
  + htslib                   1.13  hc38c3fb_0          bioconda/osx-64                            2 MB
  + jbig                      2.1  h0d85af4_2003       conda-forge/osx-64                       Cached
  + joblib                  1.0.1  pyhd8ed1ab_0        conda-forge/noarch                       Cached
  + jpeg                       9d  hbcb3906_0          conda-forge/osx-64                       Cached
  + kiwisolver              1.3.2  py39hf018cea_0      conda-forge/osx-64                        59 KB
  + krb5                   1.19.2  hcfbf3a7_0          conda-forge/osx-64                       Cached
  + lcms2                    2.12  h577c468_0          conda-forge/osx-64                       404 KB
  + lerc                    2.2.1  h046ec9c_0          conda-forge/osx-64                       Cached
  + libblas                 3.9.0  11_osx64_openblas   conda-forge/osx-64                       Cached
  + libcblas                3.9.0  11_osx64_openblas   conda-forge/osx-64                       Cached
  + libcurl                7.78.0  hf45b732_0          conda-forge/osx-64                       Cached
  + libcxx                 12.0.1  habf9029_0          conda-forge/osx-64                       Cached
  + libdeflate                1.7  h35c211d_5          conda-forge/osx-64                       Cached
  + libedit          3.1.20191231  h0678c8f_2          conda-forge/osx-64                       Cached
  + libev                    4.33  haf1e3a3_1          conda-forge/osx-64                       Cached
  + libffi                    3.3  h046ec9c_2          conda-forge/osx-64                       Cached
  + libgfortran             5.0.0  9_3_0_h6c81a4c_23   conda-forge/osx-64                       Cached
  + libgfortran5            9.3.0  h6c81a4c_23         conda-forge/osx-64                       Cached
  + liblapack               3.9.0  11_osx64_openblas   conda-forge/osx-64                       Cached
  + libnghttp2             1.43.0  h07e645a_0          conda-forge/osx-64                       Cached
  + libopenblas            0.3.17  openmp_h3351f45_1   conda-forge/osx-64                       Cached
  + libpng                 1.6.37  h7cec526_2          conda-forge/osx-64                       Cached
  + libssh2                1.10.0  h52ee1ee_0          conda-forge/osx-64                       Cached
  + libtiff                 4.3.0  h1167814_1          conda-forge/osx-64                       Cached
  + libwebp-base            1.2.1  h0d85af4_0          conda-forge/osx-64                       Cached
  + llvm-openmp            12.0.1  hda6cdc1_1          conda-forge/osx-64                       Cached
  + lz4-c                   1.9.3  he49afe7_1          conda-forge/osx-64                       Cached
  + mash                      2.3  h8503a2b_1          bioconda/osx-64                          561 KB
  + matplotlib-base         3.4.3  py39hb07454d_0      conda-forge/osx-64                         7 MB
  + ncurses                   6.2  h2e338ed_4          conda-forge/osx-64                       Cached
  + numpy                  1.21.2  py39h7eed0ac_0      conda-forge/osx-64                         6 MB
  + olefile                  0.46  pyh9f0ad1d_1        conda-forge/noarch                        32 KB
  + openjpeg                2.4.0  h6e7aa92_1          conda-forge/osx-64                       374 KB
  + openssl                1.1.1k  h0d85af4_1          conda-forge/osx-64                       Cached
  + pandas                  1.3.2  py39h4d6be9b_0      conda-forge/osx-64                        12 MB
  + patsy                   0.5.1  py_0                conda-forge/noarch                       187 KB
  + perl                   5.32.1  0_h0d85af4_perl5    conda-forge/osx-64                       Cached
  + pillow                  8.3.1  py39he9bb72f_0      conda-forge/osx-64                       660 KB
  + pip                    21.2.4  pyhd8ed1ab_0        conda-forge/noarch                       Cached
  + pybedtools              0.8.2  py39h33336d3_1      bioconda/osx-64                           12 MB
  + pyparsing               2.4.7  pyh9f0ad1d_0        conda-forge/noarch                        60 KB
  + pysam                0.16.0.1  py39h56703ae_3      bioconda/osx-64                            2 MB
  + pyseer                  1.3.9  pyh5e36f6f_0        /Users/runner/conda/conda-bld/osx-64      59 KB
  + python                  3.9.6  hd187cdc_1_cpython  conda-forge/osx-64                       Cached
  + python-dateutil         2.8.2  pyhd8ed1ab_0        conda-forge/noarch                       240 KB
  + python_abi                3.9  2_cp39              conda-forge/osx-64                       Cached
  + pytz                   2021.1  pyhd8ed1ab_0        conda-forge/noarch                       Cached
  + readline                  8.1  h05e3726_0          conda-forge/osx-64                       Cached
  + samtools                 1.13  h7596a89_0          bioconda/osx-64                          404 KB
  + scikit-learn           0.24.2  py39hd4eea88_1      conda-forge/osx-64                         7 MB
  + scipy                   1.7.1  py39h056f1c0_0      conda-forge/osx-64                        20 MB
  + setuptools             57.4.0  py39h6e9494a_0      conda-forge/osx-64                       Cached
  + six                    1.16.0  pyh6c4a22f_0        conda-forge/noarch                       Cached
  + sqlite                 3.36.0  h23a322b_0          conda-forge/osx-64                       Cached
  + statsmodels            0.12.2  py39h329c335_0      conda-forge/osx-64                        11 MB
  + threadpoolctl           2.2.0  pyh8a188c0_0        conda-forge/noarch                        16 KB
  + tk                     8.6.11  h5dbffcc_1          conda-forge/osx-64                       Cached
  + tornado                   6.1  py39h89e85a6_1      conda-forge/osx-64                       645 KB
  + tqdm                   4.62.2  pyhd8ed1ab_0        conda-forge/noarch                       Cached
  + tzdata                  2021a  he74cb21_1          conda-forge/noarch                       Cached
  + wheel                  0.37.0  pyhd8ed1ab_1        conda-forge/noarch                       Cached
  + xz                      5.2.5  haf1e3a3_1          conda-forge/osx-64                       Cached
  + zlib                   1.2.11  h7795811_1010       conda-forge/osx-64                       Cached
  + zstd                    1.5.0  h582d3a0_0          conda-forge/osx-64                       Cached

  Summary:

  Install: 78 packages

  Total download: 100 MB

────────────────────────────────────────────────────────────────────────────────────────────────────────

Updating build index: /Users/runner/conda/conda-bld

TEST START: pyseer-1.3.9-pyh5e36f6f_0.tar.bz2

## Package Plan ##

  environment location: /Users/runner/conda/conda-bld/pyseer_1630582921277/_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_pl


The following NEW packages will be INSTALLED:

    bedops:          2.4.39-h770b8ee_0        bioconda   
    bedtools:        2.30.0-haa7f73a_2        bioconda   
    bwa:             0.7.17-h188c3c3_8        bioconda   
    bzip2:           1.0.8-h0d85af4_4         conda-forge
    c-ares:          1.17.2-h0d85af4_0        conda-forge
    ca-certificates: 2021.5.30-h033912b_0     conda-forge
    capnproto:       0.6.1-h0ceac7d_2         conda-forge
    certifi:         2021.5.30-py39h6e9494a_0 conda-forge
    colorama:        0.4.4-pyh9f0ad1d_0       conda-forge
    cycler:          0.10.0-py_2              conda-forge
    dendropy:        4.5.2-pyh3252c3a_0       bioconda   
    freetype:        2.10.4-h4cff582_1        conda-forge
    glmnet_py:       1.0.2-py39hac8ec06_4     conda-forge
    gsl:             2.6-h71c5fe9_2           conda-forge
    htslib:          1.13-hc38c3fb_0          bioconda   
    jbig:            2.1-h0d85af4_2003        conda-forge
    joblib:          1.0.1-pyhd8ed1ab_0       conda-forge
    jpeg:            9d-hbcb3906_0            conda-forge
    kiwisolver:      1.3.2-py39hf018cea_0     conda-forge
    krb5:            1.19.2-hcfbf3a7_0        conda-forge
    lcms2:           2.12-h577c468_0          conda-forge
    lerc:            2.2.1-h046ec9c_0         conda-forge
    libblas:         3.9.0-11_osx64_openblas  conda-forge
    libcblas:        3.9.0-11_osx64_openblas  conda-forge
    libcurl:         7.78.0-hf45b732_0        conda-forge
    libcxx:          12.0.1-habf9029_0        conda-forge
    libdeflate:      1.7-h35c211d_5           conda-forge
    libedit:         3.1.20191231-h0678c8f_2  conda-forge
    libev:           4.33-haf1e3a3_1          conda-forge
    libffi:          3.3-h046ec9c_2           conda-forge
    libgfortran:     5.0.0-9_3_0_h6c81a4c_23  conda-forge
    libgfortran5:    9.3.0-h6c81a4c_23        conda-forge
    liblapack:       3.9.0-11_osx64_openblas  conda-forge
    libnghttp2:      1.43.0-h07e645a_0        conda-forge
    libopenblas:     0.3.17-openmp_h3351f45_1 conda-forge
    libpng:          1.6.37-h7cec526_2        conda-forge
    libssh2:         1.10.0-h52ee1ee_0        conda-forge
    libtiff:         4.3.0-h1167814_1         conda-forge
    libwebp-base:    1.2.1-h0d85af4_0         conda-forge
    llvm-openmp:     12.0.1-hda6cdc1_1        conda-forge
    lz4-c:           1.9.3-he49afe7_1         conda-forge
    mash:            2.3-h8503a2b_1           bioconda   
    matplotlib-base: 3.4.3-py39hb07454d_0     conda-forge
    ncurses:         6.2-h2e338ed_4           conda-forge
    numpy:           1.21.2-py39h7eed0ac_0    conda-forge
    olefile:         0.46-pyh9f0ad1d_1        conda-forge
    openjpeg:        2.4.0-h6e7aa92_1         conda-forge
    openssl:         1.1.1k-h0d85af4_1        conda-forge
    pandas:          1.3.2-py39h4d6be9b_0     conda-forge
    patsy:           0.5.1-py_0               conda-forge
    perl:            5.32.1-0_h0d85af4_perl5  conda-forge
    pillow:          8.3.1-py39he9bb72f_0     conda-forge
    pip:             21.2.4-pyhd8ed1ab_0      conda-forge
    pybedtools:      0.8.2-py39h33336d3_1     bioconda   
    pyparsing:       2.4.7-pyh9f0ad1d_0       conda-forge
    pysam:           0.16.0.1-py39h56703ae_3  bioconda   
    pyseer:          1.3.9-pyh5e36f6f_0       local      
    python:          3.9.6-hd187cdc_1_cpython conda-forge
    python-dateutil: 2.8.2-pyhd8ed1ab_0       conda-forge
    python_abi:      3.9-2_cp39               conda-forge
    pytz:            2021.1-pyhd8ed1ab_0      conda-forge
    readline:        8.1-h05e3726_0           conda-forge
    samtools:        1.13-h7596a89_0          bioconda   
    scikit-learn:    0.24.2-py39hd4eea88_1    conda-forge
    scipy:           1.7.1-py39h056f1c0_0     conda-forge
    setuptools:      57.4.0-py39h6e9494a_0    conda-forge
    six:             1.16.0-pyh6c4a22f_0      conda-forge
    sqlite:          3.36.0-h23a322b_0        conda-forge
    statsmodels:     0.12.2-py39h329c335_0    conda-forge
    threadpoolctl:   2.2.0-pyh8a188c0_0       conda-forge
    tk:              8.6.11-h5dbffcc_1        conda-forge
    tornado:         6.1-py39h89e85a6_1       conda-forge
    tqdm:            4.62.2-pyhd8ed1ab_0      conda-forge
    tzdata:          2021a-he74cb21_1         conda-forge
    wheel:           0.37.0-pyhd8ed1ab_1      conda-forge
    xz:              5.2.5-haf1e3a3_1         conda-forge
    zlib:            1.2.11-h7795811_1010     conda-forge
    zstd:            1.5.0-h582d3a0_0         conda-forge

Preparing transaction: ...working... done
Verifying transaction: ...working... done
Executing transaction: ...working... done
export PREFIX=/Users/runner/conda/conda-bld/pyseer_1630582921277/_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_pl
export SRC_DIR=/Users/runner/conda/conda-bld/pyseer_1630582921277/test_tmp
import: 'pyseer'
import: 'pyseer.fastlmm'
import: 'pyseer.kmer_mapping'
import: 'pyseer'
import: 'pyseer.fastlmm'
import: 'pyseer.kmer_mapping'
usage: pyseer [-h] --phenotypes PHENOTYPES
              [--phenotype-column PHENOTYPE_COLUMN]
              (--kmers KMERS | --vcf VCF | --pres PRES) [--burden BURDEN]
              [--distances DISTANCES | --load-m LOAD_M]
              [--similarity SIMILARITY | --load-lmm LOAD_LMM]
              [--save-m SAVE_M] [--save-lmm SAVE_LMM]
              [--mds {classic,metric,non-metric}]
              [--max-dimensions MAX_DIMENSIONS] [--no-distances]
              [--continuous] [--lmm] [--wg {enet,rf,blup}] [--lineage]
              [--lineage-clusters LINEAGE_CLUSTERS]
              [--lineage-file LINEAGE_FILE] [--sequence-reweighting]
              [--save-vars SAVE_VARS] [--load-vars LOAD_VARS]
              [--save-model SAVE_MODEL] [--alpha ALPHA] [--n-folds N_FOLDS]
              [--min-af MIN_AF] [--max-af MAX_AF] [--max-missing MAX_MISSING]
              [--filter-pvalue FILTER_PVALUE] [--lrt-pvalue LRT_PVALUE]
              [--cor-filter COR_FILTER] [--covariates COVARIATES]
              [--use-covariates [USE_COVARIATES ...]] [--print-samples]
              [--print-filtered] [--output-patterns OUTPUT_PATTERNS]
              [--uncompressed] [--cpu CPU] [--block_size BLOCK_SIZE]
              [--version]

SEER (doi: 10.1038/ncomms12797), reimplemented in python

optional arguments:
  -h, --help            show this help message and exit

Phenotype:
  --phenotypes PHENOTYPES
                        Phenotypes file (whitespace separated)
  --phenotype-column PHENOTYPE_COLUMN
                        Phenotype file column to use [Default: last column]

Variants:
  --kmers KMERS         Kmers file
  --vcf VCF             VCF file. Will filter any non 'PASS' sites
  --pres PRES           Presence/absence .Rtab matrix as produced by roary and
                        piggy
  --burden BURDEN       VCF regions to group variants by for burden testing
                        (requires --vcf). Requires vcf to be indexed

Distances:
  --distances DISTANCES
                        Strains distance square matrix (fixed or lineage
                        effects)
  --load-m LOAD_M       Load an existing matrix decomposition
  --similarity SIMILARITY
                        Strains similarity square matrix (for --lmm)
  --load-lmm LOAD_LMM   Load an existing lmm cache
  --save-m SAVE_M       Prefix for saving matrix decomposition
  --save-lmm SAVE_LMM   Prefix for saving LMM cache
  --mds {classic,metric,non-metric}
                        Type of multidimensional scaling [Default: classic]
  --max-dimensions MAX_DIMENSIONS
                        Maximum number of dimensions to consider after MDS
                        [Default: 10]
  --no-distances        Allow run without a distance matrix

Association options:
  --continuous          Force continuous phenotype [Default: binary auto-
                        detect]
  --lmm                 Use random instead of fixed effects to correct for
                        population structure. Requires a similarity matrix
  --wg {enet,rf,blup}   Use a whole genome model for association and
                        prediction. Population structure correction is
                        implicit.
  --lineage             Report lineage effects
  --lineage-clusters LINEAGE_CLUSTERS
                        Custom clusters to use as lineages [Default: MDS
                        components]
  --lineage-file LINEAGE_FILE
                        File to write lineage association to [Default:
                        lineage_effects.txt]

Whole genome options:
  --sequence-reweighting
                        Use --lineage-clusters to downweight sequences.
  --save-vars SAVE_VARS
                        Prefix for saving variants
  --load-vars LOAD_VARS
                        Prefix for loading variants
  --save-model SAVE_MODEL
                        Prefix for saving model
  --alpha ALPHA         Set the mixing between l1 and l2 penalties [Default:
                        0.0069]
  --n-folds N_FOLDS     Number of folds cross-validation to perform [Default:
                        10]

Filtering options:
  --min-af MIN_AF       Minimum AF [Default: 0.01]
  --max-af MAX_AF       Maximum AF [Default: 0.99]
  --max-missing MAX_MISSING
                        Maximum missing (vcf/Rtab) [Default: 0.05]
  --filter-pvalue FILTER_PVALUE
                        Prefiltering t-test pvalue threshold [Default: 1]
  --lrt-pvalue LRT_PVALUE
                        Likelihood ratio test pvalue threshold [Default: 1]
  --cor-filter COR_FILTER
                        Correlation filter for elastic net (phenotype/variant
                        correlation quantile at which to start keeping
                        variants) [Default: 0.25]

Covariates:
  --covariates COVARIATES
                        User-defined covariates file (tab-delimited, with
                        header, first column contains sample names)
  --use-covariates [USE_COVARIATES ...]
                        Covariates to use. Format is "2 3q 4" (q for
                        quantitative) [Default: load covariates but don't use
                        them]

Other:
  --print-samples       Print sample lists [Default: hide samples]
  --print-filtered      Print filtered variants (i.e. fitting errors) (does
                        not apply if --wg is used) [Default: hide them]
  --output-patterns OUTPUT_PATTERNS
                        File to print patterns to, useful for finding pvalue
                        threshold
  --uncompressed        Uncompressed kmers file [Default: gzipped]
  --cpu CPU             Processes [Default: 1]
  --block_size BLOCK_SIZE
                        Number of variants per core [Default: 3000]
  --version             show program's version number and exit
usage: square_mash [-h] [--classic] [--version]

Make a square matrix out of a mash stream

optional arguments:
  -h, --help  show this help message and exit
  --classic   Output table in a format suitable for R_mds.pl
  --version   show program's version number and exit
usage: similarity [-h] (--kmers KMERS | --vcf VCF | --pres PRES)
                  [--min-af MIN_AF] [--max-af MAX_AF]
                  [--max-missing MAX_MISSING] [--uncompressed] [--version]
                  samples

Calculate a similarity matrix using variant presence/absence information

positional arguments:
  samples               List of sample names to use

optional arguments:
  -h, --help            show this help message and exit
  --kmers KMERS         Kmers file
  --vcf VCF             VCF file. Will filter any non 'PASS' sites
  --pres PRES           Presence/absence .Rtab matrix as produced by roary and
                        piggy
  --min-af MIN_AF       Minimum AF [Default: 0.01]
  --max-af MAX_AF       Maximum AF [Default: 0.99]
  --max-missing MAX_MISSING
                        Maximum missing (vcf/Rtab) [Default: 0.05]
  --uncompressed        Uncompressed kmers file [Default: gzipped]
  --version             show program's version number and exit
usage: scree_plot_pyseer [-h] [--max-dimensions MAX_DIMENSIONS]
                         [--output OUTPUT]
                         distances

Draw a scree-plot from MDS eigenvalues

positional arguments:
  distances             Strains distance square matrix

optional arguments:
  -h, --help            show this help message and exit
  --max-dimensions MAX_DIMENSIONS
                        Maximum dimensions to plot [Default: 30]
  --output OUTPUT       Plot filename [Default: scree_plot.png]
usage: phandango_mapper [-h] [--bwa BWA] [--tmp-prefix TMP_PREFIX]
                        [--use-filter-p]
                        kmers reference output

Create Phandango Manhattan plot from kmer results

positional arguments:
  kmers                 Kmers file, filtered output from SEER
  reference             Reference fasta file
  output                Output file

optional arguments:
  -h, --help            show this help message and exit
  --bwa BWA             Location of bwa executable [Default: bwa]
  --tmp-prefix TMP_PREFIX
                        Directory to store temporary files [Default: cwd]
  --use-filter-p        Plot the unadjusted p-value [Default: lrt-p-value]
usage: annotate_hits [-h] [--bwa BWA] [--tmp-prefix TMP_PREFIX]
                     kmers references output

Iteratively annotate significant kmers from SEER

positional arguments:
  kmers                 Kmers file, filtered output from SEER
  references            File of reference annotations. First column fasta
                        sequence, second column gff annotation, third column
                        'ref' or 'draft'
  output                Output file

optional arguments:
  -h, --help            show this help message and exit
  --bwa BWA             Location of bwa executable [default=bwa]
  --tmp-prefix TMP_PREFIX
                        Directory to store temporary files [default=./]
usage: enet_predict_pyseer [-h] [--threshold THRESHOLD]
                           [--lineage-clusters LINEAGE_CLUSTERS]
                           [--true-values TRUE_VALUES] [--ignore-missing]
                           (--kmers KMERS | --vcf VCF | --pres PRES)
                           [--burden BURDEN] [--uncompressed]
                           [--covariates COVARIATES]
                           [--use-covariates [USE_COVARIATES ...]]
                           model samples

Predict phenotypes using a fitted elastic net model

positional arguments:
  model                 Name of fitted model pickle file (.pkl)
  samples               File with samples to predict

optional arguments:
  -h, --help            show this help message and exit
  --threshold THRESHOLD
                        Threshold to pick binary predictions
  --lineage-clusters LINEAGE_CLUSTERS
                        Custom clusters to use as lineages to report
                        stratified accuracy
  --true-values TRUE_VALUES
                        Pheno file with known phenotypes to calculate accuracy
  --ignore-missing      Treat missing values as REF/0 rather than using the
                        mean AF

Variants:
  --kmers KMERS         Kmers file
  --vcf VCF             VCF file. Will filter any non 'PASS' sites
  --pres PRES           Presence/absence .Rtab matrix as produced by roary and
                        piggy
  --burden BURDEN       VCF regions to group variants by for burden testing
                        (requires --vcf). Requires vcf to be indexed
  --uncompressed        Uncompressed kmers file [Default: gzipped]

Covariates:
  --covariates COVARIATES
                        User-defined covariates file (tab-delimited, no
                        header, first column contains sample names)
  --use-covariates [USE_COVARIATES ...]
                        Covariates to use. Format is "2 3q 4" (q for
                        quantitative) [Default: load covariates but don't use
                        them]

Resource usage statistics from testing pyseer:
   Process count: 4
   CPU time: Sys=0:00:01.0, User=0:00:02.5
   Memory: 104.8M
   Disk usage: 20B
   Time elapsed: 0:00:29.1


TEST END: pyseer-1.3.9-pyh5e36f6f_0.tar.bz2
--dirty flag and --keep-old-work not specified. Removing build/test folder after successful build/test.

