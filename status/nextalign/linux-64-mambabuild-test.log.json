  Package      Version  Build       Channel                                 Size
──────────────────────────────────────────────────────────────────────────────────
  Install:
──────────────────────────────────────────────────────────────────────────────────

  + nextalign    1.3.0  h9ee0642_0  /home/vsts/conda/conda-bld/linux-64     1 MB

  Summary:

  Install: 1 packages

  Total download: 1 MB

──────────────────────────────────────────────────────────────────────────────────

Updating build index: /home/vsts/conda/conda-bld

TEST START: nextalign-1.3.0-h9ee0642_0.tar.bz2

## Package Plan ##

  environment location: /home/vsts/conda/conda-bld/nextalign_1630929046926/_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_pl


The following NEW packages will be INSTALLED:

    nextalign: 1.3.0-h9ee0642_0 local

Preparing transaction: ...working... done
Verifying transaction: ...working... done
Executing transaction: ...working... done
export PREFIX=/home/vsts/conda/conda-bld/nextalign_1630929046926/_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_pl
export SRC_DIR=/home/vsts/conda/conda-bld/nextalign_1630929046926/test_tmp
nextalign 1.3.0
based on libnextalign 1.3.0


Nextclade is a part of Nextstrain project: https://nextstrain.org

Nextalign is a viral genome sequence alignment tool. It performs pairwise alignment of provided sequences against a given reference sequence using banded local alignment algorithm with affine gap-cost. Band width and rough relative positions are determined through seed matching.

Nextalign will strip insertions relative to the reference and output them in a separate CSV file.

Optionally, when provided with a gene map and a list of genes, Nextalign can perform translation of these genes.

Currently Nextalign primarily focuses on SARS-CoV-2 genome, but it can be used on any virus, given a sufficiently similar reference sequence (less than a 5% divergence).


Nextalign is a free and open-source software and the source code can be found in the Nextclade GitHub repository:
https://github.com/nextstrain/nextclade

The latest downloads are available at:
https://github.com/nextstrain/nextclade/releases

Docker container images are available at:
https://hub.docker.com/r/nextstrain/nextalign

Please report bugs and request features using GitHub Issues:
https://github.com/nextstrain/nextclade/issues/new

For questions and general discussion join Nextstrain discussion forum:
https://discussion.nextstrain.org


Quick Example:

 1. Download the example SARS-CoV-2 data files from

  https://github.com/nextstrain/nextclade/tree/master/data/sars-cov-2

  (You can also try other viruses in the `data/` directory)

 2. Run:

    nextalign --sequences=sequences.fasta --reference=reference.fasta --genemap=genemap.gff --genes=E,M,N,ORF1a,ORF1b,ORF3a,ORF6,ORF7a,ORF7b,ORF8,ORF9b,S --output-dir=output/ --output-basename=nextalign

    Add `--verbose` flag to show more information in the console. Add `--include-reference` flag to also write gap-stripped reference sequence and peptides into outputs.

 3. Find the output files in the `output/` directory:

    - nextalign.aligned.fasta - aligned input sequences
    - nextalign.gene.<gene_name>.fasta - peptides corresponding to each gene
    - nextalign.insertions.csv - list of stripped insertions for each input sequence



Usage:
  nextalign [OPTION...]

  -h, --help                    Show this help
  -v, --version                 Show version
      --version-detailed        Show detailed version
      --verbosity VERBOSITY     (optional, string) Set minimum verbosity
                                level of console output. Possible values are (from
                                least verbose to most verbose): "silent",
                                "error", "warn", "info", "debug". Default: 'warn'
                                (only errors and warnings are shown).
                                (default: warn)
      --verbose                 (optional, boolean) Increase verbosity of the
                                console output. Same as --verbosity=info.
      --silent                  (optional, boolean) Disable console output
                                entirely. --verbosity=silent.
  -j, --jobs JOBS               (optional, integer) Number of CPU threads
                                used by the algorithm. If not specified or if a
                                non-positive value specified, the algorithm
                                will use all the available threads. (default: 0)
      --in-order                Force parallel processing in-order. With this
                                flag the program will wait for results from
                                the previous sequences to be written to the
                                output files before writing the results of the
                                next sequences, preserving the same order as in
                                the input file. Due to variable sequence
                                processing times, this might introduce unnecessary
                                waiting times, but ensures that the resulting
                                sequences are written in the same order as
                                they occur in the inputs (except for sequences
                                which have errors). By default, without this
                                flag, processing might happen out of order, which
                                is faster, due to the elimination of waiting,
                                but might also lead to results written out of
                                order - the order of results is not specified
                                and depends on thread scheduling and
                                processing times of individual sequences. This option
                                is only relevant when `--jobs` is greater than
                                1 or is omitted. Note: the sequences which
                                trigger errors during processing will be omitted
                                from outputs, regardless of this flag.
  -i, --sequences SEQS          (required, string) Path to a FASTA file with
                                input sequences
  -r, --reference REF           (required, string) Path to a FASTA or plain
                                text file containing reference sequence
  -g, --genes GENES             (optional, string) List of genes to
                                translate. Requires `--genemap`. If not supplied or
                                empty, sequence will not be translated. If
                                non-empty, should contain a coma-separated list of
                                gene names. Parameters `--genes` and
                                `--genemap` should be either both specified or both
                                omitted.
  -m, --genemap GENEMAP         (optional, string) Path to a GFF file
                                containing custom gene map. Requires `--genes.` If
                                not supplied, sequence will not be translated.
                                Parameters `--genes` and `--genemap` should be
                                either both specified or both omitted.
  -d, --output-dir OUTPUT_DIR   (optional, string) Write output files to this
                                directory. The base filename can be set using
                                `--output-basename` flag. The paths can be
                                overridden on a per-file basis using
                                `--output-*` flags. If the required directory tree does
                                not exist, it will be created.
  -n, --output-basename OUTPUT_BASENAME
                                (optional, string) Set the base filename to
                                use for output files. To be used together with
                                `--output-dir` flag. By default uses the
                                filename of the sequences file (provided with
                                `--sequences`). The paths can be overridden on a
                                per-file basis using `--output-*` flags.
      --include-reference       (optional, boolean) Whether to include
                                aligned reference nucleotide sequence into output
                                nucleotide sequence fasta file and reference
                                peptides into output peptide files.
  -o, --output-fasta OUTPUT_FASTA
                                (optional, string) Path to output aligned
                                sequences in FASTA format (overrides paths given
                                with `--output-dir` and `--output-basename`).
                                If the required directory tree does not exist,
                                it will be created.
  -I, --output-insertions OUTPUT_INSERTIONS
                                (optional, string) Path to output stripped
                                insertions data in CSV format (overrides paths
                                given with `--output-dir` and
                                `--output-basename`). If the required directory tree does not
                                exist, it will be created.
  -E, --output-errors OUTPUT_ERRORS
                                (optional, string) Path to output errors and
                                warnings occurred during processing, in CSV
                                format (overrides paths given with
                                `--output-dir` and `--output-basename`). If the required
                                directory tree does not exist, it will be
                                created.
      --min-length MIN_LENGTH   (optional, integer, non-negative) Minimum
                                length of nucleotide sequence to consider for
                                alignment. If a sequence is shorter than that,
                                alignment will not be attempted and a warning
                                will be emitted. When adjusting this parameter,
                                note that alignment of short sequences can be
                                unreliable. (default: 100)
      --penalty-gap-extend PENALTY_GAP_EXTEND
                                (optional, integer, non-negative) Penalty for
                                extending a gap. If zero, all gaps regardless
                                of length incur the same penalty. (default:
                                0)
      --penalty-gap-open PENALTY_GAP_OPEN
                                (optional, integer, positive) Penalty for
                                opening of a gap. A higher penalty results in
                                fewer gaps and more mismatches. Should be less
                                than `--penalty-gap-open-in-frame` to avoid gaps
                                in genes. (default: 6)
      --penalty-gap-open-in-frame PENALTY_GAP_OPEN_IN_FRAME
                                (optional, integer, positive) As
                                `--penalty-gap-open`, but for opening gaps at the
                                beginning of a codon. Should be greater than
                                `--penalty-gap-open` and less than
                                `--penalty-gap-open-out-of-frame`, to avoid gaps in genes, but
                                favor gaps that align with codons. (default: 7)
      --penalty-gap-open-out-of-frame PENALTY_GAP_OPEN_OUT_OF_FRAME
                                (optional, integer, positive) As
                                `--penalty-gap-open`, but for opening gaps in the body of
                                a codon. Should be greater than
                                `--penalty-gap-open-in-frame` to favor gaps that align with
                                codons. (default: 8)
      --penalty-mismatch PENALTY_MISMATCH
                                (optional, integer, positive) Penalty for
                                aligned nucleotides or aminoacids that differ in
                                state during alignment. Note that this is
                                redundantly parameterized with `--score-match`.
                                (default: 1)
      --score-match SCORE_MATCH
                                (optional, integer, positive) Score for
                                encouraging aligned nucleotides or aminoacids with
                                matching state. (default: 3)
      --max-indel MAX_INDEL     (optional, integer, non-negative) Maximum
                                length of insertions or deletions allowed to
                                proceed with alignment. Alignments with long
                                indels are slow to compute and require substantial
                                memory in the current implementation.
                                Alignment of sequences with indels longer that this
                                value, will not be attempted and a warning will
                                be emitted. (default: 400)
      --nuc-seed-length NUC_SEED_LENGTH
                                (optional, integer, positive) Seed length for
                                nucleotide alignment. Seeds should be long
                                enough to be unique, but short enough to match
                                with high probability. (default: 21)
      --nuc-min-seeds NUC_MIN_SEEDS
                                (optional, integer, positive) Minimum number
                                of seeds to search for during nucleotide
                                alignment. Relevant for short sequences. In long
                                sequences, the number of seeds is determined by
                                `--nuc-seed-spacing`. Should be a positive
                                integer. (default: 10)
      --nuc-seed-spacing NUC_SEED_SPACING
                                (optional, integer, non-negative) Spacing
                                between seeds during nucleotide alignment.
                                (default: 100)
      --nuc-mismatches-allowed NUC_MISMATCHES_ALLOWED
                                (optional, integer, non-negative) Maximum
                                number of mismatching nucleotides allowed for a
                                seed to be considered a match. (default: 3)
      --aa-seed-length AA_SEED_LENGTH
                                (optional, integer, positive) Seed length for
                                aminoacid alignment. (default: 12)
      --aa-min-seeds AA_MIN_SEEDS
                                (optional, integer, positive) Minimum number
                                of seeds to search for during aminoacid
                                alignment. Relevant for short sequences. In long
                                sequences, the number of seeds is determined by
                                `--aa-seed-spacing`. (default: 10)
      --aa-seed-spacing AA_SEED_SPACING
                                (optional, integer, non-negative) Spacing
                                between seeds during aminoacid alignment.
                                (default: 100)
      --aa-mismatches-allowed AA_MISMATCHES_ALLOWED
                                (optional, integer, non-negative) Maximum
                                number of mismatching aminoacids allowed for a
                                seed to be considered a match. (default: 2)


Resource usage statistics from testing nextalign:
   Process count: 1
   CPU time: Sys=0:00:00.0, User=-
   Memory: 3.3M
   Disk usage: 16B
   Time elapsed: 0:00:02.1


TEST END: nextalign-1.3.0-h9ee0642_0.tar.bz2
--dirty flag and --keep-old-work not specified. Removing build/test folder after successful build/test.

